function IsQueryObjectPreview(){return void 0!=window.external&&void 0!=window.external.SendText}function IsDashboardEdit(){return"undefined"!==typeof UCDashboardForEditor}function UpdateQueryObjectPreview(a){for(var c=Object.keys(qv.collection)[0],c=qv.collection[c],a=JSON.parse(a),d=Object.keys(a),b=0;b<d.length;b++){var k=d[b];c[k]=a[k]}c.realShow()}
var HIGHCHARTS_COLOR_PREFIX="highcharts-color-",HIGHCHARTS_MAX_COLORS=36,HIGHCHARTS_CUSTOM_COLOR=[],qv={collection:{},fadeTimeouts:{}},QueryViewerVisible={Always:"Always",Yes:"Yes",No:"No",Never:"Never"},QueryViewerElementType={Axis:"Axis",Datum:"Datum"},QueryViewerAxisType={Rows:"Rows",Columns:"Columns",Pages:"Pages"},QueryViewerFilterType={ShowAllValues:"ShowAllValues",HideAllValues:"HideAllValues",ShowSomeValues:"ShowSomeValues"},QueryViewerAxisOrderType={None:"None",Ascending:"Ascending",Descending:"Descending",
Custom:"Custom"},QueryViewerExpandCollapseType={ExpandAllValues:"ExpandAllValues",CollapseAllValues:"CollapseAllValues",ExpandSomeValues:"ExpandSomeValues"},QueryViewerDataType={Integer:"integer",Real:"real",Character:"character",Boolean:"boolean",Date:"date",DateTime:"datetime",GUID:"guid"},QueryViewerAggregationType={Sum:"Sum",Average:"Average",Count:"Count",Max:"Max",Min:"Min"},QueryViewerOutputType={Card:"Card",Chart:"Chart",PivotTable:"PivotTable",Table:"Table",Map:"Map",Default:"Default"},QueryViewerMapType=
{Choropleth:"Choropleth",Bubble:"Bubble",Point:"Point"},QueryViewerRegion={Country:"Country",Continent:"Continent",World:"World"},QueryViewerContinent={SouthAmerica:"SouthAmerica",NorthAmerica:"NorthAmerica",Africa:"Africa",Asia:"Asia",Europe:"Europe",Oceania:"Oceania",Antarctica:"Antarctica"},QueryViewerMapLibrary={Highcharts:"Highcharts",ECharts:"ECharts"},QueryViewerChartType={Column:"Column",Column3D:"Column3D",StackedColumn:"StackedColumn",StackedColumn3D:"StackedColumn3D",StackedColumn100:"StackedColumn100",
Bar:"Bar",StackedBar:"StackedBar",StackedBar100:"StackedBar100",Area:"Area",StackedArea:"StackedArea",StackedArea100:"StackedArea100",SmoothArea:"SmoothArea",StepArea:"StepArea",Line:"Line",StackedLine:"StackedLine",StackedLine100:"StackedLine100",SmoothLine:"SmoothLine",StepLine:"StepLine",Pie:"Pie",Pie3D:"Pie3D",Doughnut:"Doughnut",Doughnut3D:"Doughnut3D",LinearGauge:"LinearGauge",CircularGauge:"CircularGauge",Radar:"Radar",FilledRadar:"FilledRadar",PolarArea:"PolarArea",Funnel:"Funnel",Pyramid:"Pyramid",
ColumnLine:"ColumnLine",Column3DLine:"Column3DLine",Timeline:"Timeline",SmoothTimeline:"SmoothTimeline",StepTimeline:"StepTimeline",Sparkline:"Sparkline"},QueryViewerConditionOperator={Equal:"EQ",LessThan:"LT",GreaterThan:"GT",LessOrEqual:"LE",GreaterOrEqual:"GE",NotEqual:"NE",Interval:"IN"},QueryViewerOrientation={Horizontal:"Horizontal",Vertical:"Vertical"},QueryViewerPlotSeries={InTheSameChart:"InTheSameChart",InSeparateCharts:"InSeparateCharts"},QueryViewerShowDataAs={Values:"Values",Percentages:"Percentages",
ValuesAndPercentages:"ValuesAndPercentages"},QueryViewerSubtotals={Yes:"Yes",Hidden:"Hidden",No:"No"},QueryViewerTrendPeriod={SinceTheBeginning:"SinceTheBeginning",LastYear:"LastYear",LastSemester:"LastSemester",LastQuarter:"LastQuarter",LastMonth:"LastMonth",LastWeek:"LastWeek",LastDay:"LastDay",LastHour:"LastHour",LastMinute:"LastMinute",LastSecond:"LastSecond"},QueryViewerXAxisLabels={Horizontally:"Horizontally",Rotated30:"Rotated30",Rotated45:"Rotated45",Rotated60:"Rotated60",Vertically:"Vertically"},
QueryViewerAutoresizeType={Both:"Both",Vertical:"Vertical",Horizontal:"Horizontal"};
qv.util={color:{getHtmlColor:function(a){return"string"==typeof a||"number"==typeof a?gx.color.toHex?-1==a?"":"#"+gx.color.toHex(a):"#"+gxToHex(a):void 0==a?"#000000":a.Html},parseCSSColor:function(a){return"rgb"==a.substring(0,3)?(a=a.replace("rgb","").replace("(","").replace(")","").split(","),this.getHtmlColor(gx.color.rgb(parseInt(a[0]),parseInt(a[1]),parseInt(a[2])))):a},convertValueToColor:function(a){a=-1==a.indexOf("#")?"#"+a:a;for(a=a.substring(1,a.length);6>a.length;)a="0"+a;return"#"+a},
lightenDarkenColor:function(a,c){var d=!1;"#"==a[0]&&(a=a.slice(1),d=!0);var b=parseInt(a,16),k=(b>>16)+c;255<k?k=255:0>k&&(k=0);var m=(b>>8&255)+c;255<m?m=255:0>m&&(m=0);b=(b&255)+c;255<b?b=255:0>b&&(b=0);return(d?"#":"")+(b|m<<8|k<<16).toString(16)}},css:function(){var a={};return{replaceCssClasses:function(c){for(;0<=(posIni=c.indexOf("gxpl_cssReplace("));){posFin=c.indexOf(")",posIni);className=c.substring(posIni+16,posFin);var d=className;if(void 0!=a[d])style=a[d];else{for(var b=d,k=void 0,
m=gx.theme+".css",n=!1,l=void 0,r=0;r<document.styleSheets.length;r++)if(null!=document.styleSheets[r].href&&0<=document.styleSheets[r].href.indexOf(m)){n=!0;k=document.styleSheets[r];break}n&&(k.cssRules?crossRules=k.cssRules:k.rules&&(crossRules=k.rules));k=Number.MAX_SAFE_INTEGER;for(r=0;r<crossRules.length;r++)m=crossRules[r],void 0!=m.selectorText&&(0==m.selectorText.toLowerCase().indexOf("."+b.toLowerCase())&&m.selectorText.length<k)&&(l=m.style,k=m.selectorText.length);styleObj=l;void 0!=styleObj?
(b=styleObj,l="",""!=b.color&&(l+=(""==l?"":";")+"color:"+qv.util.color.parseCSSColor(b.color)),""!=b.backgroundColor&&(l+=(""==l?"":";")+"backgroundColor:"+qv.util.color.parseCSSColor(b.backgroundColor)),""!=b.borderStyle&&(l+=(""==l?"":";")+"borderStyle:"+b.borderStyle),""!=b.borderWidth&&(l+=(""==l?"":";")+"borderThickness:"+b.borderWidth.replace("pt","").replace("px","")),""!=b.borderColor&&(l+=(""==l?"":";")+"borderColor:"+qv.util.color.parseCSSColor(b.borderColor)),""!=b.fontFamily&&(l+=(""==
l?"":";")+"fontFamily:"+b.fontFamily.replace(/"/g,"").replace(/'/g,"")),""!=b.fontSize&&(l+=(""==l?"":";")+"fontSize:"+b.fontSize.replace("pt","").replace("px","")),""!=b.fontWeight&&(l+=(""==l?"":";")+"fontWeight:"+b.fontWeight),""!=b.fontStyle&&(l+=(""==l?"":";")+"fontStyle:"+b.fontStyle),""!=b.textDecoration&&(l+=(""==l?"":";")+"textDecoration:"+b.textDecoration),styleTransformed=l,style=a[d]=styleTransformed):style=""}toReplace=c.substring(posIni,posFin+1);c=c.replace(toReplace,style)}return c},
parseStyle:function(a){var d="";if(""!=a&&void 0!=a){if(0>a.indexOf(":"))return a;for(var a=a.split(";"),b=0;b<a.length;b++)var k=a[b].split(":"),m=k[0],d=d+((""==d?"":",")+'"'+("borderThickness"==m?"borderWidth":m)+'":"'+k[1]+("borderThickness"==m||"fontSize"==m?"px":"")+'"');return"{"+d+"}"}return"{}"}}}(),autorefresh:function(){return{UpdateLayoutSameGroup:function(a,c,d){function b(a,b){function c(a,e){for(var b=0;b<a.Metadata.Parameters.length;b++){var h=a.Metadata.Parameters[b];if(h.IsCollection&&
h.Name==e)return[b,h]}return[null,null]}function d(a,e){for(var b=null,h=0;h<a.Parameters.length;h++)if(a.Parameters[h].Name==e){b=a.Parameters[h];break}return b}function k(a,e){for(var b="",h="I"==e.Type||"R"==e.Type||"B"==e.Type?"":'"',g=0;g<a.Filter.Values.length;g++)b+=(""==b?"":",")+h+a.Filter.Values[g]+h;return"["+b+"]"}var f=[];a._parametersCloned||(a._parametersCloned=!0,a.Parameters=qv.util.cloneObject(a.Parameters));for(var h=qv.util.GetOrderedElementsKeys(a,b),e=a.GetMetadata(),g=0;g<h.length;g++){var o=
parseInt(h[g].substr(6,4));sourceElement=b[o];var t=c(a,sourceElement.Name),o=t[0],t=t[1],q=qv.util.GetElementInCollection(e,"Name",sourceElement.Name),B=null!=q,v=!B;B&&(qv.util.MergeFields(sourceElement,q),f.push(q));v&&null!=t&&(t=k(sourceElement,t),a.Object?(q=eval(a.Object),q[o+2]=t,a.Object=JSON.stringify(q)):(o=d(a,sourceElement.Name),null==o&&(o={},o.Name=sourceElement.Name,a.Parameters.push(o)),o.Value=t))}a.Axes=f}function k(a,c,d){b(a,c);a.RememberLayout=!1;a.AllowElementsOrderChange=d;
qv.util.autorefresh.SaveAxesAndParametersState(a);a.realShow()}if(void 0!=a.AutoRefreshGroup&&null!=a.AutoRefreshGroup&&""!=a.AutoRefreshGroup&&""!=qv.util.trim(a.AutoRefreshGroup))for(index in qv.util.autorefresh.DeleteAxesAndParametersState(a),qv.collection)qViewerOther=qv.collection[index],qv.services.IsObjectSet(qViewerOther)&&(qViewerOther.userControlId()!=a.userControlId()&&a.AutoRefreshGroup==qViewerOther.AutoRefreshGroup)&&(qViewerOther._isAutorefresh=!0,void 0!=qViewerOther.Metadata&&void 0!=
qViewerOther.Metadata.Parameters?k(qViewerOther,c,d):qViewerOther.getQueryParameters(function(a,b){var l=qv.util.dom.xmlDocument(a),l=qv.util.dom.getSingleElementByTagName(l,"gxpl_ParameterCollection");void 0==b.Metadata&&(b.Metadata={});b.Metadata.Parameters=[];for(var l=qv.util.dom.getMultipleElementsByTagName(l,"gxpl_Parameter"),r=0;r<l.length;r++){var s={};s.Name=qv.util.dom.getValueNode(qv.util.dom.getSingleElementByTagName(l[r],"Name"));s.Type=qv.util.dom.getValueNode(qv.util.dom.getSingleElementByTagName(l[r],
"Type"));s.IsCollection=gx.lang.gxBoolean(qv.util.dom.getValueNode(qv.util.dom.getSingleElementByTagName(l[r],"IsCollection")));b.Metadata.Parameters.push(s)}k(b,c,d)}))},LoadAxesAndParametersState:function(a){var c=window.location.pathname+"_"+a.userControlId()+"_"+a.ObjectId+"_"+a.ObjectName+"_",d=c+"Axes",c=qv.util.storage.getItem(c+"Parameters"),d=qv.util.storage.getItem(d);null!=c&&""!=c&&(a.Parameters=JSON.parse(c),a.RememberLayout=!1);null!=d&&""!=d&&(a.Axes=JSON.parse(d),a.RememberLayout=
!1)},SaveAxesAndParametersState:function(a){var c=window.location.pathname+"_"+a.userControlId()+"_"+a.ObjectId+"_"+a.ObjectName+"_",d=c+"Axes";qv.util.storage.setItem(c+"Parameters",JSON.stringify(a.Parameters));qv.util.storage.setItem(d,JSON.stringify(a.Axes))},DeleteAxesAndParametersState:function(a){var a=window.location.pathname+"_"+a.userControlId()+"_"+a.ObjectId+"_"+a.ObjectName+"_",c=a+"Axes";qv.util.storage.removeItem(a+"Parameters");qv.util.storage.removeItem(c)}}}(),dom:{getSingleElementByTagName:function(a,
c){var d;d=this.getMultipleElementsByTagName(a,c);return 0<d.length?d[0]:null},getMultipleElementsByTagName:function(a,c){return!gx.util.browser.isIE()||12<=gx.util.browser.ieVersion()?a.getElementsByTagName(c):a.selectNodes(c)},getBooleanAttribute:function(a,c,d){a=a.getAttribute(c);return null==a?d:"true"==a.toLowerCase()},getCharacterAttribute:function(a,c,d){a=a.getAttribute(c);return null==a?d:a},getValueNode:function(a){return null==a||void 0==a?null:null!=a.firstChild&&void 0!=a.firstChild?
a.firstChild.nodeValue:null},selectXPathNode:function(a,c){var d;a.evaluate?(d=a.evaluate(c,a,null,XPathResult.ANY_TYPE,null),d=d.iterateNext()):(d=a.selectNodes(c),d=0<d.length?d[0]:null);return d},xmlDocument:function(a){var c;!gx.util.browser.isIE()||12<=gx.util.browser.ieVersion()?(parser=new DOMParser,c=parser.parseFromString(a,"text/xml")):(c=new ActiveXObject("Microsoft.XMLDOM"),c.async="false",c.loadXML(a));return c},getEmptyContainer:function(a){for(a=a.getContainerControl();a.firstChild;)a.removeChild(a.firstChild);
return a},setStyle:function(a,c){for(key in c)a.style[key]=c[key]},createText:function(a,c){var d=document.createTextNode(c);a.appendChild(d);return d},createElement:function(a,c,d,b,k,m,n){c=document.createElement(c);""!=d&&(c.id=d);""!=b&&(c.className=b);qv.util.dom.setStyle(c,k);"function"==typeof m&&(c.onclick=m);""!=n&&qv.util.dom.createText(c,n);null!=a&&a.appendChild(c);return c},createTable:function(a,c,d){a=qv.util.dom.createElement(a,"TABLE","",c,d,null,"");c=document.createElement("TBODY");
a.appendChild(c);return c},createRow:function(a){return qv.util.dom.createElement(a,"TR","","",{},null,"")},createCell:function(a,c,d,b,k){a=qv.util.dom.createElement(a,"TD","","",b,null,k);1!=c&&(a.colSpan=c);""!=d&&(a.align=d);return a},createSpan:function(a,c,d,b,k,m,n){a=qv.util.dom.createElement(a,"SPAN",c,d,k,m,n);""!=b&&(a.title=b);return a},createDiv:function(a,c,d,b,k,m){a=qv.util.dom.createElement(a,"DIV",c,d,k,null,m);""!=b&&(a.title=b);return a},createAnchor:function(a,c,d,b){return qv.util.dom.createElement(a,
"A",c,"",d,null,b)},createInput:function(a,c,d,b){a=qv.util.dom.createElement(a,"INPUT",c,"",b,null,"");""!=d&&(a.type=d);return a},createSelect:function(a,c){return qv.util.dom.createElement(a,"SELECT",c,"",{},null,"")},createOption:function(a,c,d,b){a=qv.util.dom.createElement(a,"OPTION","","",{},null,b);""!=c&&(a.value=c);d&&(a.selected=!0);return a},createIcon:function(a,c,d,b){a=qv.util.dom.createElement(a,"I","","material-icons",d,null,b);""!=c&&(a.title=c);return a}},storage:function(){function a(a,
d,b){if(b){var k=new Date;k.setTime(k.getTime()+864E5*b);b="; expires="+k.toGMTString()}else b="";document.cookie=a+"="+d+b+"; path=/"}return{setItem:function(c,d){localStorage?localStorage.setItem(c,d):a(c,d,365)},getItem:function(a){if(localStorage)return localStorage.getItem(a);a:{for(var a=a+"=",d=document.cookie.split(";"),b=0;b<d.length;b++){for(var k=d[b];" "==k.charAt(0);)k=k.substring(1,k.length);if(0==k.indexOf(a)){a=k.substring(a.length,k.length);break a}}a=null}return a},removeItem:function(c){localStorage?
localStorage.removeItem(c):a(c,"",-1)}}}(),ExecuteTracker:function(a,c){for(var d=[],b=0;b<gx.fx.ctx.trackers.length;b++)gx.fx.ctx.trackers[b].types[0]==a&&(d[d.length]=gx.fx.ctx.trackers[b]);for(b=0;b<d.length;b++){var k=gx.O;gx.O=d[b].obj;var m=gx.csv.cmpCtx;gx.csv.cmpCtx=d[b].obj.CmpContext;gx.evt.setProcessing(!1);d[b].hdl.call(d[b].obj,null,null,c);gx.O=k;gx.csv.cmpCtx=m}},satisfyStyle:function(a,c){switch(c.Operator){case QueryViewerConditionOperator.Equal:return a==c.Value1;case QueryViewerConditionOperator.GreaterThan:return a>
c.Value1;case QueryViewerConditionOperator.LessThan:return a<c.Value1;case QueryViewerConditionOperator.GreaterOrEqual:return a>=c.Value1;case QueryViewerConditionOperator.LessOrEqual:return a<=c.Value1;case QueryViewerConditionOperator.NotEqual:return a!=c.Value1;case QueryViewerConditionOperator.Interval:return a>=c.Value1&&a<=c.Value2}},isGeneXusPreview:function(){return IsQueryObjectPreview()},getGenerator:function(){return gx.gen.isDotNet()?"C#":gx.gen.isJava()?"Java":""},getErrorFromText:function(a){return'<Result OK="True"></Result>'==
a?"":a.replace('<Result OK="False"><Dsc>',"").replace("</Dsc></Result>","")},trim:function(a){return"string"!=typeof a?null:a.replace(/^[\s]+/,"").replace(/[\s]+$/,"").replace(/[\s]{2,}/," ")},capitalize:function(a){return a.charAt(0).toUpperCase()+a.slice(1)},decapitalize:function(a){return a.charAt(0).toLowerCase()+a.slice(1)},dateToString:function(a,c){var d=a.getStringWithFmt("Y4MD").replace(/\//g,"-");c&&(a.TimeFmt=24,d+=" "+a.getTimeString(!0,!0));return d},cloneObject:function(a){return JSON.parse(JSON.stringify(a))},
endsWith:function(a,c){return a.substr(a.length-c.length,c.length)==c},startsWith:function(a,c){return a.substr(0,c.length)==c},formatNumber:function(a,c,d,b){a=gx.num.formatNumber(a,c,d,0,!0,!1);if(b&&(0<=a.indexOf(".")||0<=a.indexOf(","))){for(;qv.util.endsWith(a,"0");)a=a.slice(0,-1);if(qv.util.endsWith(a,".")||qv.util.endsWith(a,","))a=a.slice(0,-1)}return a},formatDateTime:function(a,c,d,b,k,m,n){a=new gx.date.gxdate(a,"Y4MD");d=a.getStringWithFmt(d);c==QueryViewerDataType.DateTime&&(a.TimeFmt=
24,d+=" "+a.getTimeString(k,m,b,n));return d},seconsdToText:function(a){return 60>a?qv.util.formatNumber(Math.round(a),0,"ZZZZZZZZZZZZZZ9",!1)+" "+qv.util.decapitalize(gx.getMessage("GXPL_QViewerSeconds")):3600>a?qv.util.formatNumber(Math.round(a/60),0,"ZZZZZZZZZZZZZZ9",!1)+" "+qv.util.decapitalize(gx.getMessage("GXPL_QViewerMinutes")):86400>a?qv.util.formatNumber(Math.round(a/60/60),0,"ZZZZZZZZZZZZZZ9",!1)+" "+qv.util.decapitalize(gx.getMessage("GXPL_QViewerHours")):2630016>a?qv.util.formatNumber(Math.round(a/
60/60/24),0,"ZZZZZZZZZZZZZZ9",!1)+" "+qv.util.decapitalize(gx.getMessage("GXPL_QViewerDays")):31557600>a?qv.util.formatNumber(Math.round(a/60/60/24/30.44),0,"ZZZZZZZZZZZZZZ9",!1)+" "+qv.util.decapitalize(gx.getMessage("GXPL_QViewerMonths")):qv.util.formatNumber(Math.round(a/60/60/24/365.25),0,"ZZZZZZZZZZZZZZ9",!1)+" "+qv.util.decapitalize(gx.getMessage("GXPL_QViewerYears"))},ParseNumericPicture:function(a,c){var d,b,k="",m="";if(""==c)d=a==QueryViewerDataType.Integer?0:2,b=!1;else{0>c.indexOf(".")&&
0>c.indexOf(",")?(d=0,b=!1):0<=c.indexOf(".")&&0>c.indexOf(",")?(d=a==QueryViewerDataType.Integer?0:c.length-c.indexOf(".")-1,b=!1):(d=0>c.indexOf(".")&&0<=c.indexOf(",")?0:a==QueryViewerDataType.Integer?0:c.length-c.indexOf(".")-1,b=!0);for(var n=1,l=0;l<c.length;l++){var r=c.substr(l,1);if(("."==r||","==r||"9"==r||"Z"==r)&&1==n)n=2;"."!=r&&(","!=r&&"9"!=r&&"Z"!=r)&&2==n&&(n=3);switch(n){case 1:k+=r;break;case 3:m+=r}}}return{DecimalPrecision:d,UseThousandsSeparator:b,Prefix:k,Suffix:m}},ParseDateTimePicture:function(a,
c){var d=gx.dateFormat,b=a==QueryViewerDataType.DateTime,k=a==QueryViewerDataType.DateTime,m=a==QueryViewerDataType.DateTime,n=a==QueryViewerDataType.DateTime;""!=c&&(0<=c.indexOf("9999")&&0>d.indexOf("Y4")?d=d.replace("Y","Y4"):0>c.indexOf("9999")&&0<=d.indexOf("Y4")&&(d=d.replace("Y4","Y")),a==QueryViewerDataType.DateTime&&(b=c.indexOf(" "),0<=b?(n=c.substr(b+1,c.length-b),b=2<=n.length,k=5<=n.length,m=8<=n.length,n=12==n.length):n=m=k=b=!1));return{DateFormat:d,IncludeHours:b,IncludeMinutes:k,
IncludeSeconds:m,IncludeMilliseconds:n}},evaluate:function(a,c,d){for(var b=1;b<=d.length;b++)a=a.replace(c+b.toString(),d[b-1]);return eval(a)},aggregate:function(a,c,d){var a=a||QueryViewerAggregationType.Sum,b=null,k=null,m=null,n=null;switch(a){case QueryViewerAggregationType.Sum:for(a=0;a<c.length;a++)null!=c[a]&&(b+=c[a]);return b;case QueryViewerAggregationType.Average:for(a=0;a<c.length;a++)null!=c[a]&&(b+=c[a],k+=d[a]);return null!=b?b/k:null;case QueryViewerAggregationType.Count:for(a=0;a<
d.length;a++)k+=d[a];return k;case QueryViewerAggregationType.Max:for(a=0;a<c.length;a++)n=null==n?c[a]:c[a]>n?c[a]:n;return n;case QueryViewerAggregationType.Min:for(a=0;a<c.length;a++)m=null==m?c[a]:c[a]<m?c[a]:m;return m}},anyError:function(a){return 0==a.indexOf('<Result OK="False"><Dsc>')},showActivityIndicator:function(a){var c='qv.util.showActivityIndicatorMain("'+a.getContainerControl().id+'");',a=a.userControlId();qv.fadeTimeouts[a]&&clearTimeout(qv.fadeTimeouts[a]);qv.fadeTimeouts[a]=setTimeout(c,
500)},showActivityIndicatorMain:function(a){a=document.getElementById(a);gx.dom.addClass(a,"gx-qv-loading");for(var c=0;c<a.childNodes.length;c++)gx.dom.addClass(a.childNodes[c],"gx-qv-loading-children")},hideActivityIndicator:function(a){var c=a.userControlId();qv.fadeTimeouts[c]&&(clearTimeout(qv.fadeTimeouts[c]),qv.fadeTimeouts[c]=void 0);a=a.getContainerControl();gx.dom.removeClass(a,"gx-qv-loading");for(c=0;c<a.childNodes.length;c++)gx.dom.removeClass(a.childNodes[c],"gx-qv-loading-children")},
renderError:function(a,c){if(IsQueryObjectPreview()&&!IsDashboardEdit())window.external.SendText(a.ControlName,c);else{var d=qv.util.dom.getEmptyContainer(a);qv.util.dom.createDiv(d,"","gx-qv-centered-text","",{width:gx.dom.addUnits(a.Width),height:gx.dom.addUnits(a.Height),borderColor:"silver",borderWidth:"thin",borderStyle:"solid"},gx.getMessage("GXPL_QViewerError")+": "+c);a._ControlRenderedTo=void 0;qv.util.hideActivityIndicator(a)}},GetDesigntimeMetadata:function(a){for(var c=[],d=0;d<a.Metadata.Axes.length;d++){var b=
a.Metadata.Axes[d];if(!b.IsComponent){var k={};k.Name=b.Name;k.Title=b.Title;k.DataField=b.DataField;k.Visible=b.Visible;k.Type=QueryViewerElementType.Axis;k.Axis=b.Axis;k.Filter=b.Filter;k.ExpandCollapse=b.ExpandCollapse;k.AxisOrder=b.Order;k.Format={};k.Format.Subtotals=b.Subtotals;k.Format.Picture=b.Picture;k.Format.CanDragToPages=b.CanDragToPages;k.Format.Style=b.Style;0<b.ValuesStyles.length&&(k.Format.ValuesStyles=b.ValuesStyles);k.Actions={};k.Actions.RaiseItemClick=b.RaiseItemClick;c.push(k)}}for(d=
0;d<a.Metadata.Data.length;d++)b=a.Metadata.Data[d],b.IsComponent||(k={},k.Name=b.Name,k.Title=b.Title,k.DataField=b.DataField,k.Visible=b.Visible,k.Type=QueryViewerElementType.Datum,k.Axis="",k.Aggregation=b.Aggregation,k.Format={},k.Format.Picture=b.Picture,k.Format.Style=b.Style,k.Format.TargetValue=b.TargetValue,k.Format.MaximumValue=k.Format.TargetValue,0<b.ConditionalStyles.length&&(k.Format.ConditionalStyles=b.ConditionalStyles),k.Actions={},k.Actions.RaiseItemClick=b.RaiseItemClick,c.push(k));
return c},MergeFields:function(a,c){if(c.Visible!=QueryViewerVisible.Never&&(c.Visible=a.Hidden?QueryViewerVisible.No:QueryViewerVisible.Yes,c.Type==QueryViewerElementType.Axis)){c.Axis=a.Axis;if(a.Order)switch(c.AxisOrder.Type){case QueryViewerAxisOrderType.None:case QueryViewerAxisOrderType.Ascending:case QueryViewerAxisOrderType.Descending:c.AxisOrder.Type=a.Order;break;case QueryViewerAxisOrderType.Custom:a.Order==QueryViewerAxisOrderType.Descending&&c.AxisOrder.Values.reverse()}c.Format.Subtotals!=
QueryViewerSubtotals.No&&void 0!=a.Subtotals&&(c.Format.Subtotals=a.Subtotals==QueryViewerSubtotals.Yes?QueryViewerSubtotals.Yes:QueryViewerSubtotals.Hidden);a.Filter&&(c.Filter=a.Filter);a.ExpandCollapse&&(c.ExpandCollapse=a.ExpandCollapse)}},GetOrderedElementsKeys:function(a,c){function d(a,b,m){return Array(b-(""+a).length+1).join(m||"0")+a}for(var b=[],k=0;k<c.length;k++){var m=c[k],n=a.RealType==QueryViewerOutputType.Table?"0":m.Type==QueryViewerElementType.Axis?"1":"2";if(null!=m.Position){var l;
if(a.RealType==QueryViewerOutputType.PivotTable)if(m.Type==QueryViewerElementType.Axis)switch(m.Axis){case QueryViewerAxisType.Columns:l="B";break;case QueryViewerAxisType.Pages:l="C";break;default:l="A"}else l="D";else l="A";n+=l+d(m.Position,4,"0")+d(k,4,"0")}else n+="Z"+d(k,4,"0")+d(k,4,"0");b.push(n)}b.sort();return b},GetContainerControlClass:function(a){return""!=a.Class?a.Class+"-"+a.RealType.toLowerCase():""},GetContainerControlClasses:function(a){var c=qv.util.GetContainerControlClass(a),
d;switch(a.RealType){case QueryViewerOutputType.Card:d="qv-card";break;case QueryViewerOutputType.Chart:d="qv-chart";break;case QueryViewerOutputType.PivotTable:d="qv-pivottable";break;case QueryViewerOutputType.Table:d="qv-table";break;case QueryViewerOutputType.Map:d="qv-map"}""!=c&&(d+=" "+c);return d},SetUserControlClass:function(a,c){a.getContainerControl().className="gx_usercontrol "+c},GetElementInCollection:function(a,c,d){for(var b=0;b<a.length;b++){var k=a[b];if(k[c]==d)return k}return null},
IsInteger:function(a){return Number.isInteger?Number.isInteger(a):"number"===typeof a&&isFinite(a)&&Math.floor(a)===a},ApplyPicture:function(a,c,d,b){switch(d){case QueryViewerDataType.Integer:case QueryViewerDataType.Real:return qv.util.formatNumber(a,b.DecimalPrecision,c,!1);case QueryViewerDataType.Boolean:case QueryViewerDataType.Character:case QueryViewerDataType.GUID:return qv.util.trim(a);case QueryViewerDataType.Date:case QueryViewerDataType.DateTime:return qv.util.formatDateTime(a,d,b.DateFormat,
b.IncludeHours,b.IncludeMinutes,b.IncludeSeconds,b.IncludeMilliseconds)}},GetPictureProperties:function(a,c){return a==QueryViewerDataType.Integer||a==QueryViewerDataType.Real?qv.util.ParseNumericPicture(a,c):a==QueryViewerDataType.Date||a==QueryViewerDataType.DateTime?qv.util.ParseDateTimePicture(a,c):null},GetNullColor:function(){return qv.util.GetColorObject("")},GetColorObject:function(a){return{IsDefault:!1,Color:a,ColorIndex:"-1"}},GetAxisByDataField:function(a,c){for(var d=0;d<a.Metadata.Axes.length;d++)if(a.Metadata.Axes[d].DataField==
c)return a.Metadata.Axes[d]},LoadColorsObj:function(a,c,d){for(var b=0,k=0;k<c.cssRules.length;k++){var m=c.cssRules[k];if(m.selectorText&&0==m.selectorText.indexOf(d)){var n=m.selectorText.replace(d,"");a[n]=m.style.fill;b++}if(b==HIGHCHARTS_MAX_COLORS)break}},GetThemeStyleSheet:function(a){a._themeStyleSheet||(a._themeStyleSheet=qv.util.GetStyleSheet(gx.theme+".css"));return a._themeStyleSheet},GetHighchartsDefaultColors:function(a){if(!a._HighchartsDefaultColors){a._HighchartsDefaultColors=[];
var c={},d,b;d=qv.util.GetQueryViewerStyleSheet(a);qv.util.LoadColorsObj(c,d,".highcharts-color-");""!=a.Class&&(d=qv.util.GetThemeStyleSheet(a),b="."+qv.util.GetContainerControlClass(a)+" .highcharts-color-",qv.util.LoadColorsObj(c,d,b));for(d=0;d<HIGHCHARTS_MAX_COLORS;d++)a._HighchartsDefaultColors.push(c[d.toString()])}return a._HighchartsDefaultColors},SetHighchartsColor:function(a,c,d,b){qv.util.IsNullColor(d)||(a=d.IsDefault?d.ColorIndex:qv.util.AddHighchartsCustomColor(a,d.Color),b?c.colorIndex=
a:c.className=HIGHCHARTS_COLOR_PREFIX+a)},AddHighchartsCustomColor:function(a,c){var d=HIGHCHARTS_CUSTOM_COLOR.indexOf(c);if(0>d){HIGHCHARTS_CUSTOM_COLOR.push(c);var d=HIGHCHARTS_CUSTOM_COLOR.length-1,d=HIGHCHARTS_MAX_COLORS+d,b=qv.util.IsHexaColor(c)?"#":"",b="."+HIGHCHARTS_COLOR_PREFIX+d+" {fill: "+b+c+"; stroke: "+b+c+";}",k=qv.util.GetThemeStyleSheet(a);k.insertRule(b,k.cssRules.length)}else d=HIGHCHARTS_MAX_COLORS+d;return d},IsHexaColor:function(a){return 6===a.length&&!isNaN(parseInt(a,16))},
IsNullColor:function(a){return a.IsDefault?0>a.ColorIndex:""==a.Color},GetColorStringFromHighchartsObject:function(a,c){var d;d=c.className&&0==c.className.indexOf("highcharts-color-")?parseInt(c.className.replace("highcharts-color-","")):c.colorIndex;d<HIGHCHARTS_MAX_COLORS?d=qv.util.GetHighchartsDefaultColors(a)[d]:(d=HIGHCHARTS_CUSTOM_COLOR[d-HIGHCHARTS_MAX_COLORS],qv.util.IsHexaColor(d)&&(d="#"+d));return d},GetQueryViewerStyleSheet:function(a){a._queryViewerStyleSheet||(a._queryViewerStyleSheet=
qv.util.GetStyleSheet("QueryViewer.css"));return a._queryViewerStyleSheet},GetStyleSheet:function(a){for(var c,d=0;d<document.styleSheets.length;d++)if(null!=document.styleSheets[d].href&&0<=document.styleSheets[d].href.indexOf(a)){c=document.styleSheets[d];break}return c},getTitleObject:function(a,c){return""==a.Title?{text:null}:{text:null==c||0==c?a.Title:null}},XAxisDataType:function(a){for(var c=0,d="",b=0;b<a.Metadata.Axes.length;b++){var k=a.Metadata.Axes[b];if(k.Visible==QueryViewerVisible.Yes||
k.Visible==QueryViewerVisible.Always)c++,d=k.DataType}return 1==c?d:QueryViewerDataType.Character},ProcessDataAndMetadata:function(a){function c(a){for(var e=0,b=0;b<a.length;b++)"F0"!=a[b].DataField&&e++;return e}function d(a){a.Chart.Categories={};a.Chart.Categories.DataFields=[];for(var e=0;e<a.Metadata.Axes.length;e++){var b=a.Metadata.Axes[e];if(b.Visible==QueryViewerVisible.Yes||b.Visible==QueryViewerVisible.Always)(a.RealType!=QueryViewerOutputType.Map||b.DataType==QueryViewerDataType.Character)&&
a.Chart.Categories.DataFields.push(b.DataField)}a.Chart.Series={};a.Chart.Series.DataFields=[];b=c(a.Metadata.Data);for(e=0;e<a.Metadata.Data.length;e++){var h=a.Metadata.Data[e];(1==b?h.Visible==QueryViewerVisible.Yes||h.Visible==QueryViewerVisible.Always:h.Visible!=QueryViewerVisible.Never)&&a.Chart.Series.DataFields.push(h.DataField)}}function b(a){for(var e={},b=0;b<a.Metadata.Axes.length;b++){var h=a.Metadata.Axes[b],g=qv.util.GetPictureProperties(h.DataType,h.Picture);e[h.DataField]={Picture:h.Picture,
DataType:h.DataType,PictureProperties:g,Filter:h.Filter}}return e}function k(a,e){function b(a,e,h){function g(a){for(var e=!1,b=0;b<a.length;b++)if(m(a[b].StyleOrClass,!1)[0]){e=!0;break}return e}var c;if(a.RealType==QueryViewerOutputType.Map&&(a.MapType==QueryViewerMapType.Choropleth&&""!=a.Chart.colorAxis||a.MapType==QueryViewerMapType.Bubble&&""!=a.Chart.colorAxis||a.MapType==QueryViewerMapType.Point&&""!=a.Chart.colorAxis))c=!1;else if(a.RealType==QueryViewerOutputType.Map&&(a.MapType==QueryViewerMapType.Choropleth&&
0==a.Chart.colorAxis.dataClasses.length||a.MapType==QueryViewerMapType.Bubble&&0==a.Chart.colorAxis.dataClasses.length||a.MapType==QueryViewerMapType.Point&&0==a.Chart.colorAxis.dataClasses.length))c=!0;a.RealType==QueryViewerOutputType.Chart&&(qv.chart.IsSingleSerieChart(a)||a.RealChartType==QueryViewerChartType.PolarArea&&1==a.Chart.Series.DataFields.length)?c=!0:a.RealType==QueryViewerOutputType.Chart&&(qv.chart.IsAreaChart(a)||qv.chart.IsLineChart(a)||a.RealChartType==QueryViewerChartType.Radar||
a.RealChartType==QueryViewerChartType.FilledRadar)?c=!1:a.RealType==QueryViewerOutputType.Chart&&1<a.Chart.Series.DataFields.length&&!qv.chart.IsSplittedChart(a)?c=!1:(a=g(e.ConditionalStyles),e=!1,null!=h&&(e=g(h.ValuesStyles)),c=a||e);return c}for(var h={},g=c(a.Metadata.Data),d=0;d<a.Metadata.Data.length;d++){var f=a.Metadata.Data[d];if(1==g?f.Visible==QueryViewerVisible.Yes||f.Visible==QueryViewerVisible.Always:f.Visible!=QueryViewerVisible.Never){var l=b(a,f,e);h[f.DataField]={Datum:f,Multicolored:l}}}return h}
function m(a,e){var b="",h=!1,g=e?"backgroundcolor":"color";if(""!=a){for(var m=a.split(";"),c=0;c<m.length;c++){var d=m[c].split(":");if(2==d.length){var f=d[1];if(d[0].toLowerCase()==g){b=f;h=""!=f;break}}}h&&"#"==b.substr(0,1)&&(b=b.replace("#",""))}return[h,b]}function n(a,e,b,h,g,c,d){function f(a,e){for(var b=[!1,""],h=0;h<a.ValuesStyles.length;h++){var g=a.ValuesStyles[h];if(g.Value==e){b=m(g.StyleOrClass,!1);break}}return b}function l(a,e){for(var b=[!1,""],h=!1,g=0;g<a.ConditionalStyles.length;g++){var c=
a.ConditionalStyles[g];if(h=qv.util.satisfyStyle(e,c)){b=m(c.StyleOrClass,!1);break}}return b}var k,o=-1,n=!1;if(a){if(a=!1,null!=b&&(b=f(b,c),a=b[0],k=b[1]),!a)b=l(e,d),a=b[0],k=b[1],a||(o=g%HIGHCHARTS_MAX_COLORS,n=!0)}else b=m(e.Style,!1),a=b[0],k=b[1],a||(o=h%HIGHCHARTS_MAX_COLORS,n=!0);return{IsDefault:n,Color:k,ColorIndex:o}}function l(a,e,b,h){for(var g="",m="",c=0;c<a.Chart.Categories.DataFields.length;c++){var d=a.Chart.Categories.DataFields[c],f;void 0!=e[d]?(f=qv.util.trim(e[d]),d=qv.util.ApplyPicture(f,
h[d].Picture,h[d].DataType,h[d].PictureProperties)):d=f=a.Metadata.TextForNullValues;g+=(""==g?"":", ")+f;m+=(""==m?"":", ")+d}e=[g,m];h={};h.Value=e[0];h.ValueWithPicture=e[1];a.Chart.Categories.Values.push(h);if(0==b)a.Chart.Categories.MinValue=h.Value,a.Chart.Categories.MaxValue=h.Value;else if(h.Value>a.Chart.Categories.MaxValue&&(a.Chart.Categories.MaxValue=h.Value),h.Value<a.Chart.Categories.MinValue)a.Chart.Categories.MinValue=h.Value}function r(a,e,b,h,g){for(var m=0;m<a.Chart.Series.DataFields.length;m++){var c=
a.Chart.Series.ByIndex[m],d=a.Chart.Series.DataFields[m],f=void 0!=e[d]?e[d]:null,l={};l.Value=f;var k=h[d].Datum,o=h[d].Multicolored;if(k.Aggregation==QueryViewerAggregationType.Average){var q=e[d+"_N"],d=e[d+"_D"];void 0==q&&void 0==d&&(q=f,d="1");l.Value_N=q;l.Value_D=d}l.Color=o?n(o,k,g,0,b,a.Chart.Categories.Values[b].Value,f):qv.util.GetNullColor();c.Points.push(l);0<l.Value&&(c.PositiveValues=!0);0>l.Value&&(c.NegativeValues=!0);if(0===b)c.MinValue=parseFloat(l.Value),c.MaxValue=parseFloat(l.Value);
else if(parseFloat(l.Value)>c.MaxValue&&(c.MaxValue=parseFloat(l.Value)),parseFloat(l.Value)<c.MinValue)c.MinValue=parseFloat(l.Value)}}function s(a,e){for(var b=0;b<e.ConditionalStyles.length;b++){var h=e.ConditionalStyles[b],g=m(h.StyleOrClass,!0),c=g[1];if(g[0]){plotBand={};plotBand.Color=qv.util.GetColorObject(c);if(h.Operator==QueryViewerConditionOperator.Interval)plotBand.From=parseFloat(h.Value1),plotBand.To=parseFloat(h.Value2);else if(h.Operator==QueryViewerConditionOperator.Equal)plotBand.From=
parseFloat(h.Value1),plotBand.To=parseFloat(h.Value1);else if(h.Operator==QueryViewerConditionOperator.GreaterOrEqual||h.Operator==QueryViewerConditionOperator.GreaterThan)plotBand.From=parseFloat(h.Value1);else if(h.Operator==QueryViewerConditionOperator.LessOrEqual||h.Operator==QueryViewerConditionOperator.LessThan)plotBand.To=parseFloat(h.Value1);plotBand.SeriesName=""!=e.Title?e.Title:e.Name;a.Chart.PlotBands.push(plotBand)}}}function f(a,e){for(var b=!1,h=0;h<a.Metadata.Axes.length;h++){var g=
a.Metadata.Axes[h];if(g.Visible==QueryViewerVisible.Yes||g.Visible==QueryViewerVisible.Always){var c=qv.util.trim(e[g.DataField]);if(g.Filter.Type==QueryViewerFilterType.HideAllValues){b=!0;break}else if(g.Filter.Type==QueryViewerFilterType.ShowSomeValues&&0>g.Filter.Values.indexOf(c)){b=!0;break}if(a.RealType===QueryViewerOutputType.Map&&g.DataType===QueryViewerDataType.Character)if(a.Region===QueryViewerRegion.Country){if(!qv.util.startsWith(c.toUpperCase(),a.Country+"-")){b=!0;break}}else if(a.Region===
QueryViewerRegion.Continent)switch(a.Continent){case QueryViewerContinent.Africa:b=!qv.map.IsAfricanCountry(c.toUpperCase());break;case QueryViewerContinent.Asia:b=!qv.map.IsAsianCountry(c.toUpperCase());break;case QueryViewerContinent.Europe:b=!qv.map.IsEuropeanCountry(c.toUpperCase());break;case QueryViewerContinent.NorthAmerica:b=!qv.map.IsNorthAmericanCountry(c.toUpperCase());break;case QueryViewerContinent.Oceania:b=!qv.map.IsOceanianCountry(c.toUpperCase());break;case QueryViewerContinent.SouthAmerica:b=
!qv.map.IsSouthAmericanCountry(c.toUpperCase());break;default:b=!0}}}return b}function h(a){0>=a.TargetValue&&(a.TargetValue=100);0>=a.MaximumValue&&(a.MaximumValue=100);a.MaximumValue<a.TargetValue&&(a.MaximumValue=a.TargetValue)}function e(a){var e=[],b=[],h="";for(B=0;B<a.Points.length;B++){var g,c;a.Aggregation==QueryViewerAggregationType.Count?(g=0,c=parseFloat(qv.util.trim(a.Points[B].Value))):a.Aggregation==QueryViewerAggregationType.Average?(g=parseFloat(qv.util.trim(a.Points[B].Value_N)),
c=parseFloat(qv.util.trim(a.Points[B].Value_D))):(g=parseFloat(qv.util.trim(a.Points[B].Value)),c=1);e.push(g);b.push(c);""==h&&(h=a.Points[B].Color)}e=qv.util.aggregate(a.Aggregation,e,b).toString();a.Points=[{Value:e,Value_N:e,Value_D:"1",Color:h}];a.NegativeValues=0>e;a.PositiveValues=0<e}function g(a,e){a.Chart.colorAxis=a.Chart.colorAxis||{};a.Chart.colorAxis.dataClasses=a.Chart.colorAxis.dataClasses||[];for(var b=0;b<e.ConditionalStyles.length;b++){var h=e.ConditionalStyles[b];colorAxis={dataClasses:[]};
var g={};g.color=h.StyleOrClass.replace("color:","");if(h.Operator==QueryViewerConditionOperator.Interval)g.from=parseFloat(h.Value1),g.to=parseFloat(h.Value2);else if(h.Operator==QueryViewerConditionOperator.Equal)g.from=parseFloat(h.Value1),g.to=parseFloat(h.Value1);else if(h.Operator==QueryViewerConditionOperator.GreaterOrEqual||h.Operator==QueryViewerConditionOperator.GreaterThan)g.from=parseFloat(h.Value1);else if(h.Operator==QueryViewerConditionOperator.LessOrEqual||h.Operator==QueryViewerConditionOperator.LessThan)g.to=
parseFloat(h.Value1);a.Chart.colorAxis.dataClasses.push(g)}}var o=function(a){var e=qv.util.XAxisDataType(a),b;switch(a.RealType){case QueryViewerOutputType.Chart:a=qv.chart.IsDatetimeXAxis(a)?e==QueryViewerDataType.Date||e==QueryViewerDataType.DateTime:!0;b="GXPL_QViewerNoDatetimeAxis";break;case QueryViewerOutputType.Map:a=e==QueryViewerDataType.Character;b="GXPL_QViewerNoCharacterAxis";break;default:a=!0}return{IsOK:a,Error:a?"":gx.getMessage(b)}}(a);if(o.IsOK){a.Chart={};d(a);a.Chart.Categories.MinValue=
null;a.Chart.Categories.MaxValue=null;a.Chart.Categories.Values=[];o=b(a);a.Chart.Series.ByName={};a.Chart.Series.ByIndex=[];var t=1==a.Chart.Categories.DataFields.length?qv.util.GetAxisByDataField(a,a.Chart.Categories.DataFields[0]):null,q=k(a,t);a.Chart.PlotBands=[];for(var B=0;B<a.Chart.Series.DataFields.length;B++){var v=a.Chart.Series.DataFields[B],D=q[v].Datum,u={MinValue:null,MaxValue:null},v=q[v].Multicolored;u.FieldName=D.Name;u.Name=""!=D.Title?D.Title:D.Name;u.Visible=D.Visible;u.DataType=
D.DataType;u.Aggregation=D.Aggregation;var C=D.Picture;u.Picture=""==C?u.DataType==QueryViewerDataType.Integer?"ZZZZZZZZZZZZZZ9":"ZZZZZZZZZZZZZZ9.99":C;u.NumberFormat=qv.util.ParseNumericPicture(u.DataType,u.Picture);u.Color=v?qv.util.GetNullColor():n(v,D,t,B,0,"",0);u.TargetValue=D.TargetValue;u.MaximumValue=D.MaximumValue;h(u);u.PositiveValues=!1;u.NegativeValues=!1;u.Points=[];a.Chart.Series.ByName[u.Name]=u;a.Chart.Series.ByIndex.push(u);a.RealType==QueryViewerOutputType.Chart&&s(a,D);a.RealType==
QueryViewerOutputType.Map&&g(a,D)}for(B=D=0;B<a.Data.Rows.length;B++)u=a.Data.Rows[B],f(a,u)||(l(a,u,D,o),r(a,u,D,q,t),D++);if(a.RealType==QueryViewerOutputType.Chart&&qv.chart.IsGaugeChart(a))for(B=0;B<a.Chart.Series.DataFields.length;B++)u=a.Chart.Series.ByIndex[B],e(u);return""}return o.Error}};var STATE_DONE=4,STATUS_OK=200,METADATA_VERSION=2;
qv.services=function(){function a(a){return eval(a)[1].replace(/\\/g,".")}function c(a,b){var c=qv.services.RuntimeFieldsJSON(a),d=qv.services.RuntimeParametersJSON(a),k="",f="",h;a:switch(a.RealType){case QueryViewerOutputType.Table:h="IgnoreType";break a;case QueryViewerOutputType.Chart:case QueryViewerOutputType.Card:h="IgnoreTypeAndAxis";break a;default:h="IgnoreNot"}""!=a.QueryInfo&&(f=eval("("+a.QueryInfo+")"),k=f.TextForNullValues,f=gx.json.serializeJson(f.Fields));return a.ObjectName!=b.ObjectName||
a.ObjectType!=b.ObjectType||a.ObjectId!=b.ObjectId||a.Object!=b.Object||c!=b.RuntimeFieldsJSON||d!=b.RuntimeParametersJSON||k!=b.QueryInfoTextForNullValues||f!=b.QueryInfoFieldsJSON||h!=b.MetadataType?(b.ObjectName=a.ObjectName,b.ObjectType=a.ObjectType,b.ObjectId=a.ObjectId,b.Object=a.Object,b.RuntimeFieldsJSON=c,b.RuntimeParametersJSON=d,b.QueryInfoTextForNullValues=k,b.QueryInfoFieldsJSON=f,b.MetadataType=h,!0):!1}function d(a,c){function d(a,e,h){for(var a=b(a),g=0;g<e.length;g++){var c=e[g],
m="";void 0!=c[h]&&(m=c[h].Type);""!=m&&(c=qv.services.postInfo._priv.SdtWithValuesJSON("Order",m,QueryViewerAxisOrderType.Custom,c[h].Values,!1),a+=","+c)}return a}var k=qv.services.RuntimeParametersJSON(a),s=d(a,a.Axes,"AxisOrder"),f="",h="",e="",g=a.RealType==QueryViewerOutputType.Table?"PagedRecordSet":a.RealType==QueryViewerOutputType.PivotTable?"PagedLineSet":"NotPaged";""!=a.QueryInfo&&(e=eval("("+a.QueryInfo+")"),f=e.SQLSentence,h=gx.json.serializeJson(e.Parameters),e=d(a,e.Fields,"Order"));
return a.ObjectName!=c.ObjectName||a.ObjectType!=c.ObjectType||a.ObjectId!=c.ObjectId||a.Object!=c.Object||k!=c.RuntimeParametersJSON||s!=c.OrderJSON||f!=c.QueryInfoSQLSentence||h!=c.QueryInfoParametersJSON||e!=c.QueryInfoOrderJSON||g!=c.DataType?(c.ObjectName=a.ObjectName,c.ObjectType=a.ObjectType,c.ObjectId=a.ObjectId,c.Object=a.Object,c.RuntimeParametersJSON=k,c.OrderJSON=s,c.QueryInfoSQLSentence=f,c.QueryInfoParametersJSON=h,c.QueryInfoOrderJSON=e,c.DataType=g,!0):!1}function b(a){return a.RealType==
QueryViewerOutputType.Chart&&qv.chart.IsDatetimeXAxis(a)||a.RealType==QueryViewerOutputType.Card&&(a.IncludeSparkline||a.IncludeTrend)}function k(a,b){return{Success:a,Message:b}}return{url:function(){function a(b,d){var m=qv.util.getGenerator(),h;h=(new Date).getTime();var e=b.enableServerDebug?"_debug":"";switch(m){case "C#":var m=new gx.util.Url(location.href),g=m.path,g=g.substr(0,g.lastIndexOf("/")+1);urlresult=""==m.port?m.protocol+"://"+m.host+g:m.protocol+"://"+m.host+":"+m.port+g;return urlresult+
"agxpl_get"+e+".aspx?"+d+","+h;case "Java":return c(!1)+"qviewer.services.agxpl_get"+e+"?"+d+","+h;default:return""}}function b(){var a;a=""!=gx.staticDirectory?gx.staticDirectory:this.getCookie("StaticContent");return qv.util.startsWith(a,"/")?a.substr(1,a.length-1):a}function c(a){var d=gx.util.resourceUrl(gx.basePath,!0);a&&(d+=b());return d}return{getDefaultOutputURL:function(b){return a(b,"defaultoutput")},getRecordsetCacheKeyURL:function(b){return a(b,"recordsetcachekey")},getMetadataURL:function(b){return a(b,
"metadata")},getDataURL:function(b){return a(b,"data")},getAttributeValuesURL:function(b){return a(b,"attributevalues")},getPageDataForTableURL:function(b){return a(b,"pagedatafortable")},getPageDataForPivotTableURL:function(b){return a(b,"pagedataforpivottable")},getQueryParametersURL:function(b){return a(b,"queryparameters")},getDashboardSpecURL:function(b){return a(b,"dashboardspec")},getStaticDirectory:function(){return"Java"===qv.util.getGenerator()?c(!0):""}}}(),postInfo:function(){function c(a,
b){var g="",m,f,k,l,v,D,u,r,s,p,G;m=!1;for(i=0;void 0!=a.Axes[i];i++){m=!0;g+=""!=g?",":"";g+="{";f="";l=k=0;D=v="";r=u=!0;G=p=s="";var A;A=a.Axes[i];var y="",z=!1;if(void 0!=A.Format&&void 0!=A.Format.ValuesStyles)for(var w=0;void 0!=A.Format.ValuesStyles[w];w++)z=!0,y+=""!=y?",":"",y+="{",y+='"Value":"'+encodeURIComponent(A.Format.ValuesStyles[w].Value)+'"',y+=",",y+='"Style":"'+encodeURIComponent(A.Format.ValuesStyles[w].StyleOrClass)+'"',y+=",",y+='"Propagate":'+(A.Format.ValuesStyles[w].ApplyToRowOrColumn?
"true":"false"),y+="}";z&&(y='"ValuesStyles":['+y+"]");A=y;y=a.Axes[i];z="";w=!1;if(void 0!=y.Format&&void 0!=y.Format.ConditionalStyles)for(var F=0;void 0!=y.Format.ConditionalStyles[F];F++)w=!0,z+=""!=z?",":"",z+="{",z+='"Operator":"'+y.Format.ConditionalStyles[F].Operator+'"',z+=",",z+='"Value1":"'+encodeURIComponent(y.Format.ConditionalStyles[F].Value1)+'"',y.Format.ConditionalStyles[F].Operator==QueryViewerConditionOperator.Interval&&(z+=",",z+='"Value2":"'+encodeURIComponent(y.Format.ConditionalStyles[F].Value2)+
'"'),z+=",",z+='"Style":"'+encodeURIComponent(y.Format.ConditionalStyles[F].StyleOrClass)+'"',z+="}";w&&(z='"ConditionalStyles":['+z+"]");y=z;z=a.Axes[i];w="";void 0!=z.Grouping&&(w+="{",w+='"GroupByYear":'+(z.Grouping.GroupByYear?"true":"false"),w+=",",w+='"YearTitle":"'+z.Grouping.YearTitle+'"',w+=",",w+='"GroupBySemester":'+(z.Grouping.GroupBySemester?"true":"false"),w+=",",w+='"SemesterTitle":"'+z.Grouping.SemesterTitle+'"',w+=",",w+='"GroupByQuarter":'+(z.Grouping.GroupByQuarter?"true":"false"),
w+=",",w+='"QuarterTitle":"'+z.Grouping.QuarterTitle+'"',w+=",",w+='"GroupByMonth":'+(z.Grouping.GroupByMonth?"true":"false"),w+=",",w+='"MonthTitle":"'+z.Grouping.MonthTitle+'"',w+=",",w+='"GroupByDayOfWeek":'+(z.Grouping.GroupByDayOfWeek?"true":"false"),w+=",",w+='"DayOfWeekTitle":"'+z.Grouping.DayOfWeekTitle+'"',w+=",",w+='"HideValue":'+(z.Grouping.HideValue?"true":"false"),w+="}",w='"Grouping":'+w);z=w;void 0!=a.Axes[i].Format&&(f=a.Axes[i].Format.Picture?a.Axes[i].Format.Picture:"",k=a.Axes[i].Format.TargetValue?
a.Axes[i].Format.TargetValue:0,l=a.Axes[i].Format.MaximumValue?a.Axes[i].Format.MaximumValue:0,v=a.Axes[i].Format.Style?a.Axes[i].Format.Style:"",D=a.Axes[i].Format.Subtotals?a.Axes[i].Format.Subtotals:"",u=void 0!=a.Axes[i].Format.CanDragToPages?a.Axes[i].Format.CanDragToPages:!0);void 0!=a.Axes[i].Actions&&(r=a.Axes[i].Actions.RaiseItemClick);void 0!=a.Axes[i].AxisOrder&&(s=a.Axes[i].AxisOrder.Type);void 0!=a.Axes[i].ExpandCollapse&&(p=a.Axes[i].ExpandCollapse.Type);void 0!=a.Axes[i].Filter&&(G=
a.Axes[i].Filter.Type);void 0==G&&(G=QueryViewerFilterType.ShowSomeValues);g+='"Name":"'+encodeURIComponent(a.Axes[i].Name)+'"';g+=",";g+='"Caption":"'+encodeURIComponent(a.Axes[i].Title)+'"';g+=",";g+='"Aggregation":"'+a.Axes[i].Aggregation+'"';g+=",";g+='"Visible":"'+a.Axes[i].Visible+'"';g+=",";g+='"Type":"'+a.Axes[i].Type+'"';g+=",";g+='"Axis":"'+a.Axes[i].Axis+'"';g+=",";g+='"Picture":"'+encodeURIComponent(f)+'"';g+=",";g+='"TargetValue":'+k;g+=",";g+='"MaximumValue":'+l;g+=",";g+='"Style":"'+
v+'"';g+=",";g+='"Subtotals":"'+D+'"';g+=",";g+='"CanDragToPages":'+u;g+=",";g+='"RaiseItemClick":'+r;""!=s&&(f=d("Order",s,QueryViewerAxisOrderType.Custom,a.Axes[i].AxisOrder.Values,b),g+=""!=f?","+f:"");""!=p&&(p=d("ExpandCollapse",p,QueryViewerExpandCollapseType.ExpandSomeValues,a.Axes[i].ExpandCollapse.Values,b),g+=""!=p?","+p:"");""!=G&&a.Axes[i].Filter.Values&&(G=d("Filter",G,QueryViewerFilterType.ShowSomeValues,a.Axes[i].Filter.Values,b),g+=""!=G?","+G:"");g+=""!=A?","+A:"";g+=""!=y?","+y:
"";g+=""!=z?","+z:"";g+="}"}m&&(g='"RuntimeFields":['+g+"]");return g}function d(a,b,c,m,f){var k="";if(""!=b){k=k+('"'+a+'":')+"{"+('"Type":"'+b+'"');strValues="";if(b==c){existValues=!1;for(j=0;void 0!=m[j];j++)existValues=!0,strValues+=""!=strValues?",":"",strValues=f?strValues+('"'+encodeURIComponent(m[j])+'"'):strValues+('"'+m[j]+'"');existValues&&(strValues=',"Values":['+strValues+"]")}k+=strValues;k+="}"}return k}function k(a){var b="",c=!1;if(a.Object){a=eval(a.Object);for(i=2;i<a.length;i++)c=
!0,b+=""!=b?",":"",b+="{",b+='"Value":"'+encodeURIComponent(a[i])+'"',b+="}"}else for(i=0;void 0!=a.Parameters[i];i++)c=!0,b+=""!=b?",":"",b+="{",b+='"Name":"'+a.Parameters[i].Name+'"',b+=",",b+='"Value":"'+encodeURIComponent(a.Parameters[i].Value)+'"',b+="}";c&&(b='"RuntimeParameters":['+b+"]");return b}function r(a){var b="",c=!1;for(i=0;void 0!=a[i];i++){c=!0;b+=""!=b?",":"";b+="{";b+='"DataField":"'+a[i].DataField+'"';b+=",";b+='"NullIncluded":'+a[i].NullIncluded;strIncludedValues="";existValues=
!1;for(j=0;void 0!=a[i].NotNullValues.Included[j];j++)existValues=!0,strIncludedValues+=""!=strIncludedValues?",":"",strIncludedValues+='"'+encodeURIComponent(a[i].NotNullValues.Included[j])+'"';existValues&&(strIncludedValues=',"Included":['+strIncludedValues+"]");strExcludedValues="";existValues=!1;for(j=0;void 0!=a[i].NotNullValues.Excluded[j];j++)existValues=!0,strExcludedValues+=""!=strExcludedValues?",":"",strExcludedValues+='"'+encodeURIComponent(a[i].NotNullValues.Excluded[j])+'"';existValues&&
(strExcludedValues=',"Excluded":['+strExcludedValues+"]");b+=",";b+='"NotNullValues":{"DefaultAction":"'+a[i].NotNullValues.DefaultAction+'"'+strIncludedValues+strExcludedValues+"}";b+="}"}c&&(b='"Filters":['+b+"]");return b}function s(a){return a.UseRecordsetCache?'{"ActualKey":"'+a.RecordsetCache.ActualKey+'","OldKey":"'+a.RecordsetCache.OldKey+'","MinutesToKeep":'+a.MinutesToKeepInRecordsetCache+',"MaximumSize":'+a.MaximumCacheSize+"}":'{"ActualKey":"","OldKey":"","MinutesToKeep":0,"MaximumSize":0}'}
function f(b){var e;e=""+(""!=b.ParentObject.PackageName?'"ApplicationNamespace":"'+b.ParentObject.PackageName+'",':"");b.Object?e+='"ObjectName":"'+a(b.Object)+'"':(e+='"ObjectName":"'+b.ObjectName+'"',e=e+","+('"Alt_ObjectType":"'+b.ObjectType+'"'),e=e+","+('"Alt_ObjectId":'+b.ObjectId));return e}return{DefaultOutput:function(a){var b;b="{"+f(a);b+=""!=a.ObjectInfo?',"ObjectInfo":'+a.ObjectInfo:"";return"Data="+encodeURIComponent(b+"}")},RecordsetCacheKey:function(a){a="{"+f(a);return"Data="+encodeURIComponent(a+
"}")},Metadata:function(a){var b="",g=k(a),d=c(a,!0),b=b+"{"+f(a),b=b+(""!=a.QueryInfo?',"QueryInfo":'+a.QueryInfo:""),b=b+(""!=a.AppSettings?',"AppSettings":'+a.AppSettings:""),b=b+(""!=g?","+g:"")+(""!=d?","+d:"")+","+('"OutputType":"'+a.RealType+'"'),b=b+","+('"AllowElementsOrderChange":'+a.AllowElementsOrderChange),b=b+","+('"RememberLayout":'+a.RememberLayout),b=b+","+('"ShowDataLabelsIn":"'+a.ShowDataLabelsIn+'"'),b=b+","+('"RecordsetCacheInfo":'+s(a)),b=b+","+('"ReturnSampleData":'+a.ReturnSampleData);
return"Data="+encodeURIComponent(b+"}")},Data:function(a){var e="",g=k(a),d=c(a,!0),e=e+"{"+f(a),e=e+(""!=a.QueryInfo?',"QueryInfo":'+a.QueryInfo:""),e=e+(""!=a.AppSettings?',"AppSettings":'+a.AppSettings:""),e=e+(""!=g?","+g:"")+(""!=d?","+d:"")+","+('"OutputType":"'+a.RealType+'"'),e=e+","+('"SortAscendingForced":'+b(a)),e=e+","+('"AllowElementsOrderChange":'+a.AllowElementsOrderChange),e=e+","+('"RecordsetCacheInfo":'+s(a)),e=e+","+('"ReturnSampleData":'+a.ReturnSampleData);return"Data="+encodeURIComponent(e+
"}")},AttributeValues:function(a,b,g,d,t){var q="",n=k(a),v=c(a,!0),q=q+"{"+f(a),q=q+","+('"DataField":"'+b+'"')+","+('"PageNumber":'+g)+","+('"PageSize":'+d)+","+('"Filter":"'+t+'"')+(""!=a.QueryInfo?',"QueryInfo":'+a.QueryInfo:""),q=q+(""!=a.AppSettings?',"AppSettings":'+a.AppSettings:""),q=q+(""!=n?","+n:"")+(""!=v?","+v:"")+","+('"OutputType":"'+a.RealType+'"'),q=q+","+('"AllowElementsOrderChange":'+a.AllowElementsOrderChange),q=q+","+('"RecordsetCacheInfo":'+s(a)),q=q+","+('"ReturnSampleData":'+
a.ReturnSampleData);return"Data="+encodeURIComponent(q+"}")},TablePageData:function(a,b,g,d,t,q,n){var v="",D=k(a),u=c(a,!0),n=r(n),v=v+"{"+f(a),v=v+","+('"PageNumber":'+b)+","+('"PageSize":'+(gx.lang.gxBoolean(a.Paging)?g:0)),v=v+","+('"ReturnTotPages":'+d)+","+('"Order":'+('{"DataField":"'+t+'","Type":"'+q+'"}'))+(""!=n?","+n:"")+(""!=a.QueryInfo?',"QueryInfo":'+a.QueryInfo:""),v=v+(""!=a.AppSettings?',"AppSettings":'+a.AppSettings:""),v=v+(""!=D?","+D:"")+(""!=u?","+u:"")+","+('"AllowElementsOrderChange":'+
a.AllowElementsOrderChange),v=v+","+('"RecordsetCacheInfo":'+s(a)),v=v+","+('"ReturnSampleData":'+a.ReturnSampleData);return"Data="+encodeURIComponent(v+"}")},PivotTablePageData:function(a,b,g,d,t,q,n,v,D){for(var u="",C=k(a),O=c(a,!0),p="",G=!1,A=0;void 0!=t[A];A++)G=!0,p+=""!=p?",":"",p+="{",p+='"DataField":"'+t[A].DataField+'"',p+=",",p+='"Visible":'+!t[A].Hidden,p+=",",p+='"Axis":"'+t[A].Axis.Type+'"',p+=",",p+='"Position":'+(qv.util.IsInteger(t[A].Axis.Position)?t[A].Axis.Position:0),p+=",",
p+='"Order":"'+t[A].Order+'"',p+=",",p+='"Subtotals":'+t[A].Subtotals,p+="}";G&&(p='"AxesInfo":['+p+"]");t=p;p="";G=!1;for(A=0;void 0!=q[A];A++)G=!0,p+=""!=p?",":"",p+="{",p+='"DataField":"'+q[A].DataField+'"',p+=",",p+='"Visible":'+!q[A].Hidden,p+=",",p+='"Position":'+(qv.util.IsInteger(q[A].Position)?q[A].Position:0),p+="}";G&&(p='"DataInfo":['+p+"]");q=p;n=r(n);p="";G=!1;for(A=0;void 0!=v[A];A++){G=!0;p+=""!=p?",":"";p+="{";p+='"DataField":"'+v[A].DataField+'"';p+=",";p+='"NullExpanded":'+v[A].NullExpanded;
strExpandedValues="";existValues=!1;for(var y=0;void 0!=v[A].NotNullValues.Expanded[y];y++)existValues=!0,strExpandedValues+=""!=strExpandedValues?",":"",strExpandedValues+='"'+encodeURIComponent(v[A].NotNullValues.Expanded[y])+'"';existValues&&(strExpandedValues=',"Expanded":['+strExpandedValues+"]");strCollapsedValues="";existValues=!1;for(y=0;void 0!=v[A].NotNullValues.Collapsed[y];y++)existValues=!0,strCollapsedValues+=""!=strCollapsedValues?",":"",strCollapsedValues+='"'+encodeURIComponent(v[A].NotNullValues.Collapsed[y])+
'"';existValues&&(strCollapsedValues=',"Collapsed":['+strCollapsedValues+"]");p+=",";p+='"NotNullValues":{"DefaultAction":"'+v[A].NotNullValues.DefaultAction+'"'+strExpandedValues+strCollapsedValues+"}";p+="}"}G&&(p='"ExpandCollapse":['+p+"]");v=p;u=u+"{"+f(a);u=u+","+('"PageNumber":'+b)+","+('"PageSize":'+(gx.lang.gxBoolean(a.Paging)?g:0));u=u+","+('"ReturnTotPages":'+d)+","+('"ShowDataLabelsIn":"'+a.ShowDataLabelsIn+'"');u=u+(""!=t?","+t:"")+(""!=q?","+q:"")+(""!=n?","+n:"")+(""!=v?","+v:"")+(""!=
a.QueryInfo?',"QueryInfo":'+a.QueryInfo:"");u+=""!=a.AppSettings?',"AppSettings":'+a.AppSettings:"";u=u+(""!=C?","+C:"")+(""!=O?","+O:"")+","+('"AllowElementsOrderChange":'+a.AllowElementsOrderChange);u=u+","+('"RecordsetCacheInfo":'+s(a));u=u+","+('"LayoutChanged":'+D)+","+('"ReturnSampleData":'+a.ReturnSampleData);return"Data="+encodeURIComponent(u+"}")},getQueryParameters:function(a){var b;b="{"+f(a);b+=""!=a.ObjectInfo?',"ObjectInfo":'+a.ObjectInfo:"";return"Data="+encodeURIComponent(b+"}")},
DashboardSpec:function(b){var e="";b.Object&&(e=a(b.Object));b=JSON.stringify({ApplicationNamespace:b.ParentObject.PackageName,ObjectName:e,Alt_ObjectId:0});return"Data="+encodeURIComponent(b)},_priv:{RuntimeParametersJSON:function(a){return k(a)},RuntimeFieldsJSON:function(a){return c(a)},SdtWithValuesJSON:function(a,b,c,m,f){return d(a,b,c,m,f)}}}}(),RuntimeParametersJSON:function(a){return this.postInfo._priv.RuntimeParametersJSON(a)},RuntimeFieldsJSON:function(a,b){return this.postInfo._priv.RuntimeFieldsJSON(a,
b)},getXMLHttpRequest:function(){if(window.XMLHttpRequest)return new window.XMLHttpRequest;try{return new ActiveXObject("MSXML2.XMLHTTP.3.0")}catch(a){return null}},CallServerSync:function(a,b,c,d){d=d||[];d.unshift(a);a=b.call(qv.services.url,a);c=c.apply(qv.services.postInfo,d);d=qv.services.getXMLHttpRequest();d.open("POST",a,!1);d.setRequestHeader("Content-Type","application/x-www-form-urlencoded");d.send(c);return d.responseText},createAsyncServerCallFn:function(a,b,c,d,k){return function(f,
h){h=h||[];h.unshift(a);var e=function(b){k&&a.RealType!=QueryViewerOutputType.Card&&(b=k.call(qv.util.css,b));f(b,a)};if(gx.lang.gxBoolean(a.IsExternalQuery))e(a.ExternalQueryResultObj()[d]);else{var g=b.call(qv.services.url,a),o=c.apply(qv.services.postInfo,h),t=qv.services.getXMLHttpRequest(),q=function(){t.readyState==STATE_DONE&&t.status==STATUS_OK&&e(t.responseText)};gx.util.browser.isIE()?t.onreadystatechange=q:t.onload=q;t.open("POST",g);t.setRequestHeader("Content-Type","application/x-www-form-urlencoded");
t.send(o)}}},parseRecordsetCacheKeyXML:function(a){""!=a.xml.recordsetCacheKey&&(a.RecordsetCache=a.RecordsetCache||{},a.RecordsetCache.OldKey=a.RecordsetCache.ActualKey?a.RecordsetCache.ActualKey:"",a.RecordsetCache.ActualKey=a.xml.recordsetCacheKey)},parseDataXML:function(a){if(""!=a.xml.data){var b=qv.util.dom.xmlDocument(a.xml.data),b=qv.util.dom.getSingleElementByTagName(b,"Recordset");a.Data=a.Data||{};b=gx.util.browser.isIE()?qv.util.dom.getMultipleElementsByTagName(qv.util.dom.getSingleElementByTagName(b,
"Page"),"Record"):qv.util.dom.getMultipleElementsByTagName(b,"Record");a.Data.Rows=[];for(var c=0;c<b.length;c++){for(var d={},k=0;k<b[c].childNodes.length;k++){var f=b[c].childNodes[k];1==f.nodeType&&(d[f.nodeName]=1==f.childNodes.length?f.childNodes[0].nodeValue:"")}a.Data.Rows.push(d)}}},parseMetadataXML:function(a){function b(a,c){if("greaterequal"==a&&"lessequal"==c)return QueryViewerConditionOperator.Interval;switch(a){case "equal":return QueryViewerConditionOperator.Equal;case "less":return QueryViewerConditionOperator.LessThan;
case "greater":return QueryViewerConditionOperator.GreaterThan;case "lessequal":return QueryViewerConditionOperator.LessOrEqual;case "greaterequal":return QueryViewerConditionOperator.GreaterOrEqual;case "notequal":return QueryViewerConditionOperator.NotEqual}}function c(a,b,e,g){var d={},a=qv.util.dom.getSingleElementByTagName(a,b);if(null!=a){d.GroupFound=!0;d.TotalValueFound=!1;e=qv.util.dom.getMultipleElementsByTagName(a,e);d.Values=[];for(a=0;a<e.length;a++)b=null!=e[a].firstChild?e[a].firstChild.nodeValue:
"","TOTAL"==b&&g?d.TotalValueFound=!0:d.Values.push(b)}else d.GroupFound=!1;return d}function d(a){if(0==a.indexOf("gxpl_cssReplace("))var b=a.indexOf("gxpl_cssReplace("),c=a.indexOf(")",b),a=a.substring(b+16,c);return a}function s(a){for(var a=qv.util.dom.getSingleElementByTagName(a,"formatValues"),a=null!=a?qv.util.dom.getMultipleElementsByTagName(a,"value"):[],b=[],c=0;c<a.length;c++){var e={};e.Value=qv.util.trim(null!=a[c].firstChild?a[c].firstChild.nodeValue:"");e.StyleOrClass=d(a[c].getAttribute("format"));
e.ApplyToRowOrColumn="yes"==a[c].getAttribute("recursive");b.push(e)}return b}function f(a){for(var a=qv.util.dom.getSingleElementByTagName(a,"conditionalFormats"),a=null!=a?qv.util.dom.getMultipleElementsByTagName(a,"rule"):[],c=[],e=0;e<a.length;e++){var g={};g.Operator=b(a[e].getAttribute("op1"),a[e].getAttribute("op2"));g.Value1=parseFloat(a[e].getAttribute("value1"));g.Operator==QueryViewerConditionOperator.Interval&&(g.Value2=parseFloat(a[e].getAttribute("value2")));g.StyleOrClass=d(a[e].getAttribute("format"));
c.push(g)}return c}if(""!=a.xml.metadata){var h=qv.util.dom.xmlDocument(a.xml.metadata),e=qv.util.dom.getSingleElementByTagName(h,"OLAPCube"),h=e.getAttribute("Version");if(null==h||parseInt(h)==METADATA_VERSION){a.Metadata=a.Metadata||{};a.Metadata.TextForNullValues=e.getAttribute("textForNullValues");var g=qv.util.dom.getMultipleElementsByTagName(e,"OLAPDimension");a.Metadata.Axes=[];for(h=0;h<g.length;h++){var o={};o.Name=g[h].getAttribute("name");o.Title=g[h].getAttribute("displayName");o.DataField=
g[h].getAttribute("dataField");o.DataType=g[h].getAttribute("dataType");o.Visible=g[h].getAttribute("visible");o.Axis=g[h].getAttribute("axis");o.Picture=g[h].getAttribute("picture");if(""==o.Picture)switch(o.DataType){case QueryViewerDataType.Integer:o.Picture="ZZZZZZZZZZZZZZ9";break;case QueryViewerDataType.Real:o.Picture="ZZZZZZZZZZZZZZ9.99";break;case QueryViewerDataType.Date:o.Picture="99/99/9999";break;case QueryViewerDataType.DateTime:o.Picture="99/99/9999 99:99:99";break;case QueryViewerDataType.GUID:o.Picture=
"XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX"}o.CanDragToPages=qv.util.dom.getBooleanAttribute(g[h],"canDragToPages",!0);o.RaiseItemClick=qv.util.dom.getBooleanAttribute(g[h],"raiseItemClick",!0);o.IsComponent=qv.util.dom.getBooleanAttribute(g[h],"isComponent",!1);o.Style=g[h].getAttribute("format");var t=c(g[h],"include","value",!0),q=c(g[h],"exclude","value",!0),B=c(g[h],"expand","value",!1),v=c(g[h],"customOrder","Value",!1);o.Subtotals="no"==g[h].getAttribute("summarize")?QueryViewerSubtotals.No:q.GroupFound&&
q.TotalValueFound?QueryViewerSubtotals.Hidden:QueryViewerSubtotals.Yes;o.Filter={};!t.GroupFound&&!q.GroupFound?(o.Filter.Type=QueryViewerFilterType.ShowAllValues,o.Filter.Values=[]):!t.GroupFound&&q.GroupFound&&0==q.Values.length&q.TotalValueFound?(o.Filter.Type=QueryViewerFilterType.ShowAllValues,o.Filter.Values=[]):t.GroupFound&&!q.GroupFound&&0==t.Values.length?(o.Filter.Type=QueryViewerFilterType.HideAllValues,o.Filter.Values=[]):(o.Filter.Type=QueryViewerFilterType.ShowSomeValues,o.Filter.Values=
t.Values);o.ExpandCollapse={};B.GroupFound?B.GroupFound&&0==B.Values.length?(o.ExpandCollapse.Type=QueryViewerExpandCollapseType.CollapseAllValues,o.ExpandCollapse.Values=[]):(o.ExpandCollapse.Type=QueryViewerExpandCollapseType.ExpandSomeValues,o.ExpandCollapse.Values=B.Values):(o.ExpandCollapse.Type=QueryViewerExpandCollapseType.ExpandAllValues,o.ExpandCollapse.Values=[]);o.Order={};t=g[h].getAttribute("order");null==t?(o.Order.Type=QueryViewerAxisOrderType.None,o.Order.Values=[]):(o.Order.Type=
qv.util.capitalize(t),o.Order.Values=o.Order.Type==QueryViewerAxisOrderType.Custom?v.Values:[]);o.ValuesStyles=s(g[h]);a.Metadata.Axes.push(o)}e=qv.util.dom.getMultipleElementsByTagName(e,"OLAPMeasure");a.Metadata.Data=[];for(h=0;h<e.length;h++)g={},g.Name=e[h].getAttribute("name"),g.Title=e[h].getAttribute("displayName"),g.DataField=e[h].getAttribute("dataField"),g.Aggregation=e[h].getAttribute("aggregation"),g.DataType=e[h].getAttribute("dataType"),g.Visible=e[h].getAttribute("visible"),g.Picture=
e[h].getAttribute("picture"),g.RaiseItemClick=qv.util.dom.getBooleanAttribute(e[h],"raiseItemClick",!0),g.IsComponent=qv.util.dom.getBooleanAttribute(e[h],"isComponent",!1),""==g.Picture&&(g.Picture=g.DataType==QueryViewerDataType.Integer?"ZZZZZZZZZZZZZZ9":"ZZZZZZZZZZZZZZ9.99"),g.Aggregation=qv.util.capitalize(g.Aggregation),g.TargetValue=parseFloat(e[h].getAttribute("targetValue")),g.MaximumValue=parseFloat(e[h].getAttribute("maximumValue")),g.Style=e[h].getAttribute("format"),0>=g.TargetValue&&
(g.TargetValue=100),0>=g.MaximumValue&&(g.MaximumValue=100),g.ConditionalStyles=f(e[h]),o=qv.util.dom.getCharacterAttribute(e[h],"formula",""),g.IsFormula=""!=o,g.Formula=o,a.Metadata.Data.push(g);a.Metadata.ParserResult=k(!0,"")}else a.Metadata.ParserResult=k(!1,gx.getMessage("GXPL_QViewerWrongMetadataVersion").replace("{0}",METADATA_VERSION))}},GetDataIfNeeded:function(a,b){a.Data=a.Data||{};a.Data.LastServiceCallKey=a.Data.LastServiceCallKey||{};void 0==a.xml.data||d(a,a.Data.LastServiceCallKey)||
gx.lang.gxBoolean(a.IsExternalQuery)?a.calculatePivottableData(b):b(a.xml.data,a)},GetMetadataIfNeeded:function(a,b){a.Metadata=a.Metadata||{};a.Metadata.LastServiceCallKey=a.Metadata.LastServiceCallKey||{};void 0==a.xml.metadata||c(a,a.Metadata.LastServiceCallKey)||gx.lang.gxBoolean(a.IsExternalQuery)?a.calculatePivottableMetadata(b):b(a.xml.metadata,a)},GetDashboardSpecIfNeeded:function(b,c){b.DashboardSpec=b.DashboardSpec||"";b.LastServiceCallKey=b.LastServiceCallKey||{};var d;if(!(d=void 0==b.DashboardSpec))if(d=
b.LastServiceCallKey,b.Object){var k=a(b.Object);k!=d.ObjectName?(d.ObjectName=k,d=!0):d=!1}else d=""==b.DashboardSpec;d?(b.LoadingSpec=!0,b.GetDashboardSpec(c)):c(b.DashboardSpec,b)},GetRecordsetCacheKeyIfNeeded:function(a,b){a.UseRecordsetCache&&!gx.lang.gxBoolean(a.IsExternalQuery)?(a.RecordsetCache=a.RecordsetCache||{},a.RecordsetCache.LastServiceCallKey=a.RecordsetCache.LastServiceCallKey||{},void 0==a.xml.recordsetCacheKey||d(a,a.RecordsetCache.LastServiceCallKey)?a.getRecordsetCacheKey(b):
b(a.xml.recordsetCacheKey,a)):b("",a)},IsObjectSet:function(a){return a.Object||""!=a.ObjectName||""!=a.ObjectType&&0!=a.ObjectId}}}();
qv.pivot=function(){function a(a){var c=qv.util.GetContainerControlClasses(a);""!=c&&qv.util.SetUserControlClass(a,c);c=a.userControlId()+"_"+a.RealObjectName().replace(/,/g,"").replace(/\./g,"")+"_pivot_page";a.pivotParams={};a.pivotParams.page=c;var d=a.userControlId()+"_"+a.RealObjectName().replace(/,/g,"").replace(/\./g,"")+"_pivot_content";a.pivotParams.content=d;if(a._ControlRenderedTo!=a.RealType||0==jQuery("#"+d).length)if(a._ControlRenderedTo!=a.RealType&&a.RealType==QueryViewerOutputType.PivotTable){var n=
qv.util.dom.getEmptyContainer(a);qv.util.dom.createDiv(n,c,"","",{},"");qv.util.dom.createDiv(n,d,"","",{},"")}else jQuery("#"+a.ContainerName).find(".pivot_filter_div").attr("id",c),jQuery("#"+a.ContainerName).find(".conteiner_table_div").attr("id",d);a.pivotParams.container=a.getContainerControl();a.pivotParams.RealType=a.RealType;a.pivotParams.ObjectName=a.RealObjectName();a.pivotParams.ControlName=a.ControlName;a.pivotParams.PageSize=a.Paging&&"false"!=a.Paging?a.PageSize:void 0;a.pivotParams.metadata=
a.xml.metadata;c=gx.lang.gxBoolean(a.IsExternalQuery)?a.xml.data:a.RealType==QueryViewerOutputType.Table?a.ServerPagingForTable?a.xml.pageData:a.xml.data:a.ServerPagingForPivotTable?a.xml.pageData:a.xml.data;a.pivotParams.data=c;a.pivotParams.UcId=a.userControlId();a.pivotParams.AutoResize=gx.lang.gxBoolean(a.AutoResize)||gx.lang.gxBoolean(a.ShrinkToFit);a.pivotParams.DisableColumnSort=a.DisableColumnSort;a.pivotParams.RememberLayout=a.RememberLayout;a.pivotParams.ShowDataLabelsIn=a.ShowDataLabelsIn;
a.pivotParams.ServerPaging=a.ServerPagingForTable&&!gx.lang.gxBoolean(a.IsExternalQuery);a.pivotParams.ServerPagingPivot=a.ServerPagingForPivotTable&&!gx.lang.gxBoolean(a.IsExternalQuery);a.pivotParams.ServerPagingCacheSize=0;a.pivotParams.UseRecordsetCache=a.UseRecordsetCache&&!gx.lang.gxBoolean(a.IsExternalQuery);a.pivotParams.AllowSelection=a.AllowSelection;a.pivotParams.SelectLine=!0;void 0!=OAT.Loader?renderJSPivot(a.pivotParams,qv.collection,a):OAT.Loader.addListener(function(){renderJSPivot(a.pivotParams,
qv.collection,a)});a._ControlRenderedTo=a.RealType;a.RealType==QueryViewerOutputType.Table&&qv.util.hideActivityIndicator(a)}function c(b){b.getPageDataForTable(function(b,c){(new Date).getTime();qv.util.anyError(b)?(errMsg=qv.util.getErrorFromText(b),qv.util.renderError(c,errMsg)):(""!=b&&(c.xml.pageData=b),a(c))},[1,b.PageSize,!0,"","",[]])}function d(a,c){var d=[];if(null!=a)for(var n=-1,l=0;l<a.childNodes.length;l++)if("ITEM"==a.childNodes[l].nodeName){var r=a.childNodes[l].getAttribute("name");
if(0>c.indexOf(r)){n++;d[n]={};d[n].Name=r;d[n].Values=[];for(var r=-1,s=a.childNodes[l],f=0;f<a.childNodes[l].childNodes.length;f++)if("VALUES"==a.childNodes[l].childNodes[f].nodeName){s=a.childNodes[l].childNodes[f];break}for(f=0;f<s.childNodes.length;f++)"VALUE"==s.childNodes[f].nodeName&&(r++,d[n].Values[r]=null!=s.childNodes[f].firstChild?s.childNodes[f].firstChild.nodeValue:"")}}return d}return{tryToRenderPivotTable:function(b){var d="",m=(new Date).getTime();b.xml=b.xml||{};qv.services.GetRecordsetCacheKeyIfNeeded(b,
function(b,l){var r=!1;b!=l.xml.recordsetCacheKey&&(l.xml.recordsetCacheKey=b,r=!0);qv.util.anyError(b)?(d=qv.util.getErrorFromText(b),qv.util.renderError(l,d)):(r&&qv.services.parseRecordsetCacheKeyXML(l),qv.services.GetMetadataIfNeeded(l,function(b,f){var h=false;if(b!=f.xml.metadata){f.xml.metadata=b;h=true}var e=(new Date).getTime();if(qv.util.anyError(b)){d=qv.util.getErrorFromText(b);qv.util.renderError(f,d)}else{h&&qv.services.parseMetadataXML(f);if(f.Metadata.ParserResult.Success)if(f.ServerPagingForTable&&
f.RealType==QueryViewerOutputType.Table&&!gx.lang.gxBoolean(f.IsExternalQuery)){h=false;OAT.getStateWhenServingPaging&&(h=OAT.getStateWhenServingPaging(f.userControlId()+"_"+f.ObjectName,f.ObjectName));!h||!f.RememberLayout?c(f,m,e):a(f)}else if(f.ServerPagingForPivotTable&&f.RealType==QueryViewerOutputType.PivotTable&&!gx.lang.gxBoolean(f.IsExternalQuery)){h=false;OAT.getStateWhenServingPaging&&(h=OAT.getStateWhenServingPaging(f.userControlId()+"_"+f.ObjectName,f.ObjectName));a(f)}else qv.services.GetDataIfNeeded(f,
function(b,c){if(b!=c.xml.data)c.xml.data=b;(new Date).getTime();if(qv.util.anyError(b)){d=qv.util.getErrorFromText(b);qv.util.renderError(c,d)}else a(c)});else qv.util.renderError(f,f.Metadata.ParserResult.Message)}}))})},GetMetadataPivot:function(a){var c=qv.util.GetDesigntimeMetadata(a);if(0<c.length){for(var d=a.oat_element.getMetadataXML(),d=qv.pivot.GetRuntimeMetadata(d,a.RealType),n=[],a=qv.util.GetOrderedElementsKeys(a,d),l=0;l<a.length;l++)for(var r=parseInt(a[l].substr(6,4)),r=d[r],s,f=
0;f<c.length;f++)if(s=c[f],s.Name==r.Name){s=qv.util.cloneObject(s);qv.util.MergeFields(r,s);n.push(s);break}return n}return[]},GetRuntimeMetadata:function(a,c){function d(a,b,c,e,g){var b=qv.util.dom.getValueNode(qv.util.dom.getSingleElementByTagName(a,b)),f=[];if(b==e&&(a=qv.util.dom.getSingleElementByTagName(a,c),null!=a)){a=qv.util.dom.getMultipleElementsByTagName(a,"value");for(c=0;c<a.length;c++)e=qv.util.trim(qv.util.dom.getValueNode(a[c])),null!=e&&("TOTAL"!=e.toUpperCase()||!g)&&f.push(e)}return{Type:b,
Values:f}}var n=qv.util.dom.xmlDocument(a),n=qv.util.dom.getSingleElementByTagName(n,"OLAPCube"),l=[],r;r=qv.util.dom.getMultipleElementsByTagName(n,"OLAPDimension");for(var s=0;s<r.length;s++){var f={},h=qv.util.dom.getValueNode(qv.util.dom.getSingleElementByTagName(r[s],"name")),e="true"==qv.util.dom.getValueNode(qv.util.dom.getSingleElementByTagName(r[s],"hidden")),g=qv.util.dom.getValueNode(qv.util.dom.getSingleElementByTagName(r[s],"axis")),o=qv.util.dom.getValueNode(qv.util.dom.getSingleElementByTagName(r[s],
"position")),t=qv.util.dom.getValueNode(qv.util.dom.getSingleElementByTagName(r[s],"summarize")),q=qv.util.dom.getValueNode(qv.util.dom.getSingleElementByTagName(r[s],"order"));f.Name=h;f.Type=QueryViewerElementType.Axis;f.Hidden=e;f.Axis=null!=g&&""!=g&&"null"!=g?qv.util.capitalize(g):null;f.Position=o;f.Order=null!=q&&""!=q&&"null"!=q?qv.util.capitalize(q):null;c==QueryViewerOutputType.Table?(f.Filter=d(r[s],"","include",null,!0),f.Filter.Type=QueryViewerFilterType.ShowSomeValues):(f.Subtotals=
"no"==t?QueryViewerSubtotals.No:QueryViewerSubtotals.Yes,f.Filter=d(r[s],"filterType","include",QueryViewerFilterType.ShowSomeValues,!0),f.ExpandCollapse=d(r[s],"collapseType","includeExpand",QueryViewerExpandCollapseType.ExpandSomeValues,!1));l.push(f)}r=qv.util.dom.getMultipleElementsByTagName(n,"OLAPMeasure");for(s=0;s<r.length;s++)f={},h=qv.util.dom.getValueNode(qv.util.dom.getSingleElementByTagName(r[s],"name")),e="true"==qv.util.dom.getValueNode(qv.util.dom.getSingleElementByTagName(r[s],"hidden")),
o=qv.util.dom.getValueNode(qv.util.dom.getSingleElementByTagName(r[s],"position")),f.Name=h,f.Type=QueryViewerElementType.Datum,f.Hidden=e,f.Position=o,l.push(f);return l},GetDataPivot:function(a){return a.oat_element.getDataXML()},GetFilteredDataPivot:function(a){return a.oat_element.getFilteredDataXML()},onOAT_PIVOTDragAndDropEvent:function(a,c){if(a.RealType==QueryViewerOutputType.PivotTable&&(IsQueryObjectPreview()&&window.external.SendText(a.ControlName,c),a.DragAndDrop)){var d=qv.util.dom.xmlDocument(c),
d=qv.util.dom.selectXPathNode(d,"/DATA");a.DragAndDropData.Name=d.getAttribute("name");a.DragAndDropData.Type=QueryViewerElementType.Axis;axis=d.getAttribute("axis");a.DragAndDropData.Axis="rows"==axis?QueryViewerAxisType.Rows:"columns"==axis?QueryViewerAxisType.Columns:QueryViewerAxisType.Pages;a.DragAndDropData.Position=d.getAttribute("position");a.DragAndDrop()}},onItemClickEvent:function(a,c,m){var n,l;if(a.ItemClick&&!m||a.ItemDoubleClick&&m){l=m?l=a.ItemDoubleClickData:a.ItemClickData;var r=
qv.util.dom.xmlDocument(c),s=qv.util.dom.selectXPathNode(r,"/DATA/ITEM"),c=qv.util.dom.selectXPathNode(r,"/DATA/CONTEXT/RELATED"),r=qv.util.dom.selectXPathNode(r,"/DATA/CONTEXT/FILTERS");l.Name=s.getAttribute("name");n=s.getAttribute("location");switch(n){case "rows":l.Type=QueryViewerElementType.Axis;l.Axis=QueryViewerAxisType.Rows;break;case "columns":l.Type=QueryViewerElementType.Axis;l.Axis=QueryViewerAxisType.Columns;break;case "pages":l.Type=QueryViewerElementType.Axis;l.Axis=QueryViewerAxisType.Pages;
break;default:l.Type=QueryViewerElementType.Datum,l.Axis=""}l.Value=null!=s.firstChild?s.firstChild.nodeValue:"";l.Selected="true"==s.getAttribute("selected");s=[];for(n=0;n<a.Metadata.Axes.length;n++)a.Metadata.Axes[n].IsComponent&&s.push(a.Metadata.Axes[n].Name);for(n=0;n<a.Metadata.Data.length;n++)a.Metadata.Data[n].IsComponent&&s.push(a.Metadata.Data[n].Name);l.Context=d(c,s);l.Filters=d(r,s);m?a.ItemDoubleClick():a.ItemClick()}},onItemExpandCollapseEvent:function(a,c,d){var n;IsQueryObjectPreview()&&
window.external.SendText(a.ControlName,c);if(a.ItemExpand&&!d||a.ItemCollapse&&d){n=d?n=a.ItemCollapseData:a.ItemExpandData;var c=qv.util.dom.xmlDocument(c),l=qv.util.dom.selectXPathNode(c,"/DATA/ITEM"),c=qv.util.dom.selectXPathNode(c,"/DATA/CONTEXT/EXPANDEDVALUES");n.Name=l.getAttribute("name");n.Value=l.firstChild.nodeValue;n.ExpandedValues=[];for(var l=-1,r=0;r<c.childNodes.length;r++)"VALUE"==c.childNodes[r].nodeName&&(l++,n.ExpandedValues[l]=c.childNodes[r].firstChild.nodeValue);d?a.ItemCollapse():
a.ItemExpand()}},Select:function(a,c){a.oat_element.selectValue(c)},Deselect:function(a){a.oat_element.deselectValue()}}}();var HCChart,_highChartsDrawPointsWrapped,DEFAULTCHARTSPACING=10;
qv.chart=function(){function a(a){return a.RealChartType==QueryViewerChartType.Timeline||a.RealChartType==QueryViewerChartType.SmoothTimeline||a.RealChartType==QueryViewerChartType.StepTimeline}function c(b){return a(b)||b.RealChartType==QueryViewerChartType.Sparkline}function d(a){return a.RealChartType==QueryViewerChartType.Pie||a.RealChartType==QueryViewerChartType.Pie3D||a.RealChartType==QueryViewerChartType.Doughnut||a.RealChartType==QueryViewerChartType.Doughnut3D}function b(a){return a.RealChartType==
QueryViewerChartType.Radar||a.RealChartType==QueryViewerChartType.FilledRadar||a.RealChartType==QueryViewerChartType.PolarArea}function k(a){return d(a)||a.RealChartType==QueryViewerChartType.Funnel||a.RealChartType==QueryViewerChartType.Pyramid}function m(a){return(a.RealChartType==QueryViewerChartType.ColumnLine||a.RealChartType==QueryViewerChartType.Column3DLine)&&1<a.Chart.Series.DataFields.length}function n(a){return a.RealChartType==QueryViewerChartType.CircularGauge||a.RealChartType==QueryViewerChartType.LinearGauge}
function l(a){return a.RealChartType==QueryViewerChartType.StackedColumn||a.RealChartType==QueryViewerChartType.StackedColumn3D||a.RealChartType==QueryViewerChartType.StackedColumn100||a.RealChartType==QueryViewerChartType.StackedBar||a.RealChartType==QueryViewerChartType.StackedBar100||a.RealChartType==QueryViewerChartType.StackedArea||a.RealChartType==QueryViewerChartType.StackedArea100||a.RealChartType==QueryViewerChartType.StackedLine||a.RealChartType==QueryViewerChartType.StackedLine100?!1:(a.PlotSeries==
QueryViewerPlotSeries.InSeparateCharts||k(a))&&1<a.Chart.Series.DataFields.length}function r(a,b){for(var c=[],e=0;e<a.Charts.length;e++)for(var d=0;d<a.Charts[e].series.length;d++)c.push(a.Charts[e].series[d].data[b]);return c}function s(a,b,c,e,d){for(var g=0;g<a.Charts.length;g++)if(b.id!=a.Charts[g].container.id)for(var f=0;f<a.Charts[g].series.length;f++){var h=a.Charts[g].series[f].data[c];e?(d&&h.setState("hover"),a.Charts[g].tooltip.hide(0)):h.setState()}}function f(a){switch(a){case QueryViewerChartType.Column:case QueryViewerChartType.Column3D:case QueryViewerChartType.StackedColumn:case QueryViewerChartType.StackedColumn3D:case QueryViewerChartType.StackedColumn100:case QueryViewerChartType.PolarArea:return"column";
case QueryViewerChartType.Bar:case QueryViewerChartType.StackedBar:case QueryViewerChartType.StackedBar100:case QueryViewerChartType.LinearGauge:return"bar";case QueryViewerChartType.Area:case QueryViewerChartType.StackedArea:case QueryViewerChartType.StackedArea100:case QueryViewerChartType.FilledRadar:case QueryViewerChartType.StepArea:return"area";case QueryViewerChartType.SmoothArea:return"areaspline";case QueryViewerChartType.Line:case QueryViewerChartType.StackedLine:case QueryViewerChartType.StackedLine100:case QueryViewerChartType.Radar:case QueryViewerChartType.Timeline:case QueryViewerChartType.StepTimeline:case QueryViewerChartType.Sparkline:case QueryViewerChartType.StepLine:return"line";
case QueryViewerChartType.SmoothLine:case QueryViewerChartType.SmoothTimeline:return"spline";case QueryViewerChartType.ColumnLine:case QueryViewerChartType.Column3DLine:return"column";case QueryViewerChartType.Pie:case QueryViewerChartType.Pie3D:case QueryViewerChartType.Doughnut:case QueryViewerChartType.Doughnut3D:return"pie";case QueryViewerChartType.Funnel:return"funnel";case QueryViewerChartType.Pyramid:return"pyramid";case QueryViewerChartType.CircularGauge:return"solidgauge";default:return"line"}}
function h(a,b,c,e,d,g,f){function h(a,b){var c={};c.Name=a.Name;var e=qv.util.GetPictureProperties(a.DataType,a.Picture),e=qv.util.ApplyPicture(b,a.Picture,a.DataType,e);c.Values=[e];return c}a.Name=c;a.Type=e;a.Axis="";a.Value=d;a.Selected=g;a.Context=[];for(c=0;c<b.Metadata.Axes.length;c++)e=b.Metadata.Axes[c],e.IsComponent||(e=h(e,f[e.DataField]),a.Context.push(e));for(c=0;c<b.Metadata.Data.length;c++)e=b.Metadata.Data[c],e.IsComponent||(e=h(e,f[e.DataField]),a.Context.push(e));a.Filters=[]}function e(a,
b){for(var c=!1,e=0;e<a.length;e++)for(var d=a[e],g=0;g<d.series.length;g++){var f=d.series[g].points[b];if(f.selected){f.select();break}else f.select(!0,0<g),c=!0}return c}function g(a){for(var b=0;b<a.length;b++){var c=a[b].getSelectedPoints();0<c.length&&c[0].select(!1,!1)}}function o(a){var b=qv.collection[this.chart.options.qv.viewerId],c=!1;if(b.SelectionAllowed())if("Point"==b.SelectionType){if(a.point.select(),c=a.point.selected,b.PlotSeries==QueryViewerPlotSeries.InSeparateCharts&&c)for(var d=
0;d<b.Charts.length;d++){var g=b.Charts[d].series[0].points[a.point.index];g!=a.point&&g.select(!1)}}else c=e(b.Charts,a.point.index);b.ItemClick&&b.Metadata.Data[a.point.series.index].RaiseItemClick&&(d=b.Chart.Series.ByName[this.name],g=qv.util.formatNumber(a.point.y,d.NumberFormat.DecimalPrecision,d.Picture,!1),h(b.ItemClickData,b,d.FieldName,QueryViewerElementType.Datum,g,c,b.Data.Rows[a.point.index]),b.ItemClick())}function t(a,b){return""==b?qv.util.dom.createSpan(null,"","","",{fontWeight:"bold"},
null,a).outerHTML:qv.util.dom.createSpan(null,"","","",{fontWeight:"bold",color:b},null,a).outerHTML}function q(a,b){var c=Math.min(b.getContainerControl().offsetHeight,b.getContainerControl().offsetWidth)/(l(b)?b.Chart.Series.DataFields.length:1)/13;return qv.util.dom.createSpan(null,"","","",{color:qv.util.GetColorStringFromHighchartsObject(b,a),fontSize:c+"px"},null,qv.util.formatNumber(a.point.y,2,"ZZZZZZZZZZZZZZ9.99",!0)+"%").outerHTML}function B(a,b){function c(a){for(var b=a.y,e=a.series.data,
a=a.index,d="",d=a,g=a+1;g<e.length&&e[g].y==b;g++)d=g;d<e.length-1&&d++;for(var f=a,g=a-1;0<=g&&e[g].y==b;g--)f=g;b=(e[d].x-e[f].x)/1E3;return d=" ("+gx.getMessage("GXPL_QViewerDuration")+": "+qv.util.seconsdToText(b)+")"}var e,d=qv.collection[a.points[0].series.chart.options.qv.viewerId];l(d)?e=r(d,a.points[0].point.index):(e=[],$.each(a.points,function(a,b){e.push(b.point)}));for(var g={},f=!1,h=0;h<e.length;h++){var k=e[h].series.name;void 0==g[k]&&(g[k]=[]);g[k].push(e[h]);1<g[k].length&&(f=
!0)}var h="",q,M;for(M in g){var k=b[M],o=g[M],t=qv.util.GetColorStringFromHighchartsObject(d,o[0]);f&&(h+=qv.util.dom.createSpan(null,"","","",{fontWeight:"bold",color:t},null,M).outerHTML+"<br/>");for(var m=0;void 0!=o[m];m++){var p=o[m],n=parseInt(p.real_x?p.real_x:p.x);if(0<e.length&&e[0].series.chart.options.qv.comparing)h+=p.name+": "+qv.util.formatNumber(p.y,k.NumberFormat.DecimalPrecision,k.Picture,!1)+"<br/>";else{q!=n&&(h+=p.name+"<br/>",q=n);var n=d.RealChartType==QueryViewerChartType.StepTimeline?
c(p):"",v=qv.util.dom.createSpan(null,"","","",{color:t},null,M+": ").outerHTML,p=qv.util.dom.createSpan(null,"","","",{fontWeight:"bold"},null,qv.util.formatNumber(p.y,k.NumberFormat.DecimalPrecision,k.Picture,!1)).outerHTML,h=h+(v+p+n+"<br/>")}}}return h}function v(a){"undefined"===typeof _avoidSelectionEventHandler&&(_avoidSelectionEventHandler=!1);if(!_avoidSelectionEventHandler){y(Y,"none");Y=null;if(a.xAxis){var b=a.target.options.qv,c=a.xAxis[0];U(a.target.options.qv.viewerId,100*((c.min-b.dataMin)/
(b.dataMax-b.dataMin)),100*((c.max-b.dataMin)/(b.dataMax-b.dataMin)))}else U(a.target.options.qv.viewerId,0,100);b=qv.collection[a.target.options.qv.viewerId];if(l(b)){var b=b.getContainerControl().id,b=$("[id^="+b+"_chart]"),e=[];$.each(b,function(b,c){if(c.id!=a.target.renderTo.id){var d=$("#"+c.id).highcharts();e.push(d)}});$.each(e,function(b,e){a.xAxis?e.get("xaxis").setExtremes(c.min,c.max):(_avoidSelectionEventHandler=!0,e.zoomOut(),_avoidSelectionEventHandler=!1)})}}}function D(a,b,c,e,d){function g(a,
b,c,e,d){function f(a,b){return a==QueryViewerDataType.Date?10==b.length:" "==b.charAt(10)}function h(a,b,c,e,d){var g=a.substr(0,4),f=a.substr(5,2),a=a.substr(8,2);e||(b=b.replace("M",""));d||(b=b.replace("D",""));for(var x="",I=0;I<b.length;I++)x+=0==I?"":"/",x+=b.charAt(I);b=x.replace("Y",c?g:g.substr(2,2));e&&(b=b.replace("M",f));d&&(b=b.replace("D",a));return b}var x,I;if(""!=a)switch(d=d||(c==QueryViewerDataType.Date?"Days":"Seconds"),d){case "Years":x=a.substr(0,4)+"-01-01";I=h(x,e,f(c,b),
!1,!1);break;case "Months":x=a.substr(0,7)+"-01";I=h(x,e,f(c,b),!0,!1);break;case "Semesters":x="06">=a.substr(5,2)?"01":"07";x=a.substr(0,5)+x+"-01";d="06">=a.substr(5,2)?"01":"02";dateStrSemester=a.substr(0,5)+d+"-01";I=h(dateStrSemester,e,f(c,b),!0,!1);break;case "Quarters":x="03">=a.substr(5,2)?"01":"06">=a.substr(5,2)?"04":"09">=a.substr(5,2)?"07":"10";x=a.substr(0,5)+x+"-01";d="03">=a.substr(5,2)?"01":"06">=a.substr(5,2)?"02":"09">=a.substr(5,2)?"03":"04";dateStrQuarter=a.substr(0,5)+d+"-01";
I=h(dateStrQuarter,e,f(c,b),!0,!1);break;case "Weeks":a=new gx.date.gxdate(a,"Y4MD");x=gx.date.dow(a);a=gx.date.dtadd(a,-86400*(x-1));x=qv.util.dateToString(a,!1);I=h(x,e,f(c,b),!0,!0);break;case "Days":x=c==QueryViewerDataType.Date?a:a.substr(0,10);I=c==QueryViewerDataType.Date?b:b.substr(0,10);break;case "Hours":x=a.substr(0,13)+":00:00";I=b.substr(0,13)+":00";break;case "Minutes":x=a.substr(0,16)+":00";I=b.substr(0,16);break;case "Seconds":x=a,I=b}else I=x="";return{dateStr:x,name:I}}var f;f={dateStr:null,
name:null};var h=[],k=[],l=[];for(i=0;i<b.length;i++){var M=a.Values[i].ValueWithPicture,q=a.Values[i].Value,o,t;null!=b[i].Value?e==QueryViewerAggregationType.Count?(o=0,t=parseFloat(qv.util.trim(b[i].Value))):e==QueryViewerAggregationType.Average?(o=parseFloat(qv.util.trim(b[i].Value_N)),t=parseFloat(qv.util.trim(b[i].Value_D))):(o=parseFloat(qv.util.trim(b[i].Value)),t=1):(o=null,t=0);M=g(q,M,c,gx.dateFormat,d);M.dateStr==f.dateStr||0==i?(null!=o&&(h.push(o),k.push(t)),0==i&&(f=M)):(f={x:f.dateStr,
y:qv.util.aggregate(e,h,k),name:f.name},l.push(f),f=M,h=[o],k=[t])}0<h.length&&0<k.length&&(f={x:f.dateStr,y:qv.util.aggregate(e,h,k),name:f.name},l.push(f));return l}function u(b){var c,e,d;a(b)?(b=DEFAULTCHARTSPACING,c=0,e=DEFAULTCHARTSPACING,d=0):d=e=c=b=DEFAULTCHARTSPACING;return[b,c,e,d]}function C(a,b){var c,e;c=3>=a?24:50/(a-1)-1;e=100-(c+1)*(b-1);return{Width:c,Center:e,LowerExtreme:e-c/2,UpperExtreme:e+c/2}}function O(a,b){var c=1/a/2,e=-0.5+(b-0.5)/a;return{Width:c,Center:e,LowerExtreme:e-
c/2,UpperExtreme:e+c/2}}function p(e,g,h){var p=qv.util.XAxisDataType(e)==QueryViewerDataType.Date?"Days":"Seconds",K={qv:{}};K.qv.viewerId=e.userControlId();K.chart=function(b,c){var e={styledMode:!0};e.spacing=u(b);if(l(b)){var d=b.userControlId(),d=a(b)?E(d):d;e.renderTo=document.getElementById(d+"_chart"+c.toString())}else e.renderTo=a(b)?document.getElementById(E(b.userControlId())):b.getContainerControl();m(b)||(e.type=f(b.RealChartType));b.RealChartType==QueryViewerChartType.Radar||b.RealChartType==
QueryViewerChartType.FilledRadar||b.RealChartType==QueryViewerChartType.PolarArea?e.polar=!0:b.RealChartType==QueryViewerChartType.Column3D||b.RealChartType==QueryViewerChartType.StackedColumn3D||b.RealChartType==QueryViewerChartType.Column3DLine?e.options3d={enabled:!0,alpha:15,beta:15,depth:50,viewDistance:25}:b.RealChartType==QueryViewerChartType.Pie3D||b.RealChartType==QueryViewerChartType.Doughnut3D?e.options3d={enabled:!0,alpha:45,beta:0}:a(b)&&(e.zoomType="x",e.resetZoomButton={theme:{display:"none"}},
e.events={},e.events.selection=function(a){v(a)});return e}(e,h);K.credits={enabled:!1};K.legend={enabled:1<e.Chart.Series.DataFields.length&&!l(e)||k(e),margin:0};K.title=qv.util.getTitleObject(e,h);K.subtitle=function(a,b){var c={};if(l(a)&&(k(a)||a.RealChartType==QueryViewerChartType.CircularGauge))c.text=b.Name,c.floating=!0,c.align="left",c.verticalAlign="middle";return c}(e,g);K.pane=function(a,b){var c={};if(a.RealChartType==QueryViewerChartType.CircularGauge){c.background=[];var e;l(a)&&(e=
C(1,1));var d=0,g;for(g in a.Chart.Series.ByName){if(!l(a)||d==b){var f=a.Chart.Series.ByName[g],h={};l(a)||(e=C(a.Chart.Series.DataFields.length,d+1));h.outerRadius=e.UpperExtreme.toString()+"%";h.innerRadius=e.LowerExtreme.toString()+"%";f=qv.util.IsNullColor(f.Color)?f.Points[0].Color:f.Color;qv.util.SetHighchartsColor(a,h,f,!1);h.borderWidth=0;c.background.push(h)}d++}}return c}(e,h);K.xAxis=function(a,e){xAxis={};if(a.RealChartType!=QueryViewerChartType.CircularGauge){var d=c(a);if(a.RealChartType!=
QueryViewerChartType.Radar&&a.RealChartType!=QueryViewerChartType.FilledRadar&&a.RealChartType!=QueryViewerChartType.PolarArea&&a.RealChartType!=QueryViewerChartType.LinearGauge&&a.RealChartType!=QueryViewerChartType.Sparkline){var g=xAxis,f="";if(""==a.XAxisTitle)for(var h=0;h<a.Metadata.Axes.length;h++){var x=a.Metadata.Axes[h];if(x.Visible==QueryViewerVisible.Yes||x.Visible==QueryViewerVisible.Always)f+=(""==f?"":", ")+gx.getMessage(x.Title)}else f=gx.getMessage(a.XAxisTitle);g.title={text:f}}else{a.RealChartType==
QueryViewerChartType.Sparkline&&l(a)&&(xAxis.title={text:a.Chart.Series.ByIndex[e].Name});xAxis.lineWidth=0;if(a.RealChartType==QueryViewerChartType.LinearGauge||a.RealChartType==QueryViewerChartType.Sparkline)xAxis.tickPositions=[];xAxis.tickmarkPlacement=a.RealChartType==QueryViewerChartType.Radar||a.RealChartType==QueryViewerChartType.FilledRadar?"on":"between"}if(a.RealChartType==QueryViewerChartType.LinearGauge){var g=0,k;l(a)&&(k=O(1,1));xAxis.plotBands=[];for(var o in a.Chart.Series.ByName){if(!l(a)||
g==e)f=a.Chart.Series.ByName[o],l(a)||(k=O(a.Chart.Series.DataFields.length,g+1)),plotBand={},f=qv.util.IsNullColor(f.Color)?f.Points[0].Color:f.Color,qv.util.SetHighchartsColor(a,plotBand,f,!1),plotBand.from=k.LowerExtreme,plotBand.to=k.UpperExtreme,xAxis.plotBands.push(plotBand);g++}}d||(xAxis.categories=[]);k=!1;for(g=0;g<a.Chart.Categories.Values.length;g++)""!=a.Chart.Categories.Values[g].ValueWithPicture&&(k=!0),d||(xAxis.categories[g]=a.Chart.Categories.Values[g].ValueWithPicture);if(d)xAxis.type=
"datetime",xAxis.id="xaxis",xAxis.minRange=1,qv.util.XAxisDataType(a)==QueryViewerDataType.Date&&(null!=a.Chart.Categories.MaxValue&&null!=a.Chart.Categories.MinValue)&&(d=new gx.date.gxdate(a.Chart.Categories.MinValue,"Y4MD"),864E6>(new gx.date.gxdate(a.Chart.Categories.MaxValue,"Y4MD")).Value.getTime()-d.Value.getTime()&&(xAxis.tickInterval=864E5));else if(xAxis.labels={},xAxis.labels.enabled=k,a.XAxisLabels!=QueryViewerXAxisLabels.Horizontally&&!(a.RealChartType==QueryViewerChartType.Bar||a.RealChartType==
QueryViewerChartType.StackedBar||a.RealChartType==QueryViewerChartType.StackedBar100)&&!b(a))a.XAxisLabels==QueryViewerXAxisLabels.Vertically?(d=90,k=5):(d=parseInt(a.XAxisLabels.replace("Rotated","")),k=10),xAxis.labels.rotation=360-d,xAxis.labels.y=k,xAxis.labels.align="right";b(a)?xAxis.className="highcharts-no-axis-line highcharts-yes-grid-line":a.RealChartType==QueryViewerChartType.Sparkline&&(xAxis.className="highcharts-no-axis-line highcharts-no-grid-line")}return xAxis}(e,h);K.yAxis=function(a,
b){function c(a){if(0==a.length)return!1;for(var b,e=0;e<a.length;e++)if(0==e)b=a[e].Picture;else if(a[e].Picture!=b)return!1;return!0}if(a.RealChartType==QueryViewerChartType.Sparkline)yAxis={visible:!1};else{var e;e=a.RealChartType==QueryViewerChartType.CircularGauge?null:l(a)?b.Name:G(a);m(a)&&!l(a)?(yAxis=[],yAxis[0]={title:{text:e}},yAxis[1]={title:{text:""},opposite:!0}):yAxis={title:{text:e}};yAxis.plotLines=[];yAxis.plotBands=[];if(!d(a)&&!(a.RealChartType==QueryViewerChartType.Funnel||a.RealChartType==
QueryViewerChartType.Pyramid)&&!n(a)){for(var g=0;g<a.Chart.PlotBands.length;g++){var f=a.Chart.PlotBands[g];if(null==b||b.Name==f.SeriesName)f.From==f.To&&null!=f.From?(e={value:f.From,width:1,zIndex:3},qv.util.SetHighchartsColor(a,e,f.Color,!1),yAxis.plotLines.push(e)):(e={},qv.util.SetHighchartsColor(a,e,f.Color,!1),e.from=!f.From?Number.MIN_VALUE:f.From,e.to=!f.To?Number.MAX_VALUE:f.To,yAxis.plotBands.push(e))}if(l(a)||1==a.Chart.Series.ByIndex.length||c(a.Chart.Series.ByIndex)){var h=l(a)?b:
a.Chart.Series.ByIndex[0];yAxis.labels={};yAxis.labels.formatter=function(){return qv.util.formatNumber(this.value,h.NumberFormat.DecimalPrecision,h.Picture,true)}}}if(a.RealChartType==QueryViewerChartType.Radar||a.RealChartType==QueryViewerChartType.FilledRadar||a.RealChartType==QueryViewerChartType.PolarArea)yAxis.min=0,yAxis.gridLineInterpolation=a.RealChartType==QueryViewerChartType.Radar||a.RealChartType==QueryViewerChartType.FilledRadar?"polygon":"circle";if(n(a)){yAxis.min=0;yAxis.max=0;for(var x in a.Chart.Series.ByName)if(!l(a)||
x==b.Name)e=a.Chart.Series.ByName[x],yAxis.max=Math.max(yAxis.max,100*e.MaximumValue/e.TargetValue);if(a.RealChartType==QueryViewerChartType.LinearGauge||100!=yAxis.max){e={className:"highcharts-dashed-plot-line",value:100};if(l(a)||1==a.Chart.Series.DataFields.length){var g=l(a)?b:a.Chart.Series.ByIndex[0],k,o;a.RealChartType==QueryViewerChartType.LinearGauge?(f=-10,k=-5,o="right"):(f=15,k=0,o="center");e.label={text:g.TargetValue,verticalAlign:"bottom",rotation:0,y:f,x:k,align:o}}yAxis.plotLines.push(e)}}a.RealChartType==
QueryViewerChartType.LinearGauge?(yAxis.className="highcharts-no-axis-line highcharts-no-grid-line",yAxis.labels={enabled:!1}):a.RealChartType==QueryViewerChartType.CircularGauge&&(yAxis.lineWidth=0,yAxis.tickPositions=[]);if(gx.lang.gxBoolean(a.XAxisIntersectionAtZero)){f=g=!1;for(x in a.Chart.Series.ByName)e=a.Chart.Series.ByName[x],e.PositiveValues&&(g=!0),e.NegativeValues&&(f=!0);f||(m(a)&&!l(a)?(yAxis[0].min=0,yAxis[1].min=0):yAxis.min=0);g||(m(a)&&!l(a)?(yAxis[0].max=0,yAxis[1].max=0):yAxis.max=
0)}}return yAxis}(e,g);K.plotOptions=function(b,c){function e(a){var b;b=l(a)||1==a.Chart.Series.DataFields.length?23*(l(a)?a.Chart.Series.DataFields.length:1):29;return a.getContainerControl().offsetHeight-b}function d(a){var b={radius:1,symbol:"circle",states:{hover:{radius:4}}};a.SelectionAllowed()&&(b.states.select={radius:5,lineWidth:1});return b}var g=gx.lang.gxBoolean(c.ShowValues),f={series:{}};f.series.events={};c.RealChartType==QueryViewerChartType.CircularGauge?(f.series.dataLabels={},
f.series.dataLabels.enabled=1==c.Chart.Series.DataFields.length&&gx.lang.gxBoolean(c.ShowValues)||l(c),f.series.dataLabels.y=0,f.series.dataLabels.borderWidth=0,f.series.dataLabels.formatter=function(){return q(this,c)},f.series.marker={enabled:!1}):g&&(f.series.dataLabels={},f.series.dataLabels.enabled=!0,f.series.dataLabels.connectorColor="#000000",f.series.dataLabels.formatter=function(){var a=c.Chart.Series.ByName[this.series.name];return qv.util.formatNumber(this.point.y*(c.RealChartType==QueryViewerChartType.LinearGauge?
a.TargetValue/100:1),a.NumberFormat.DecimalPrecision,a.Picture,!1)},c.RealChartType==QueryViewerChartType.LinearGauge&&(f.series.dataLabels.inside=!0));if(l(c)&&c.RealChartType!=QueryViewerChartType.CircularGauge){f.series.point={};f.series.point.events={};var h=c.RealChartType!=QueryViewerChartType.LinearGauge;f.series.point.events.mouseOver=function(){s(c,this.series.chart.container,this.index,true,h)};f.series.point.events.mouseOut=function(){s(c,this.series.chart.container,this.index,false,h)}}if(c.ItemClick||
c.SelectionAllowed())f.series.events.click=o;switch(b){case "bar":f.bar={};c.RealChartType==QueryViewerChartType.StackedBar?(f.series.stacking="normal",f.bar.stacking="normal"):c.RealChartType==QueryViewerChartType.StackedBar100&&(f.series.stacking="percent",f.bar.stacking="percent");if(c.RealChartType==QueryViewerChartType.LinearGauge){g=O(c.Chart.Series.DataFields.length,1).Width*e(c);f.bar.pointWidth=g;f.bar.pointPadding=0;f.bar.groupPadding=0;for(var x=Number.MAX_VALUE,k=0;k<c.Chart.Series.DataFields.length;k++){var t=
c.Chart.Series.ByIndex[k],t=t.Points[0].Value/t.TargetValue;t<x&&(x=t)}x*=c.getContainerControl().offsetWidth;f.bar.borderRadius=Math.min(g/2,x/2)}break;case "column":f.column={};c.RealChartType==QueryViewerChartType.StackedColumn||c.RealChartType==QueryViewerChartType.StackedColumn3D||c.RealChartType==QueryViewerChartType.PolarArea?(f.series.stacking="normal",f.column.stacking="normal"):c.RealChartType==QueryViewerChartType.StackedColumn100&&(f.series.stacking="percent",f.column.stacking="percent");
c.RealChartType==QueryViewerChartType.PolarArea&&(f.column.pointPadding=0,f.column.groupPadding=0);break;case "area":f.area={};c.RealChartType==QueryViewerChartType.StepArea&&(f.area.step="center");f.area.marker=d(c);c.RealChartType==QueryViewerChartType.StackedArea?f.area.stacking="normal":c.RealChartType==QueryViewerChartType.StackedArea100&&(f.area.stacking="percent");break;case "areaspline":f.areaspline={};f.areaspline.marker=d(c);break;case "line":f.line={};f.line.marker=d(c);c.RealChartType==
QueryViewerChartType.StepLine?f.line.step="center":c.RealChartType==QueryViewerChartType.StepTimeline&&(f.line.step="left");a(c)?f.series.connectNulls=!0:c.RealChartType==QueryViewerChartType.StackedLine?f.line.stacking="normal":c.RealChartType==QueryViewerChartType.StackedLine100&&(f.line.stacking="percent");break;case "spline":f.spline={};f.spline.marker=d(c);break;case "pie":f.pie={};if(c.RealChartType==QueryViewerChartType.Doughnut||c.RealChartType==QueryViewerChartType.Doughnut3D)f.pie.innerSize=
"35%";if(c.RealChartType==QueryViewerChartType.Pie3D||c.RealChartType==QueryViewerChartType.Doughnut3D)f.pie.depth=35;f.pie.dataLabels={enabled:g};f.pie.showInLegend=!0;break;case "solidgauge":f.solidgauge={};f.solidgauge.showInLegend=!0;f.solidgauge.rounded=!0;break;case "funnel":f.funnel={};f.funnel.showInLegend=!0;f.funnel.dataLabels={enabled:g};break;case "pyramid":f.pyramid={},f.pyramid.showInLegend=!0,f.pyramid.dataLabels={enabled:g}}return f}(K.chart.type,e);K.tooltip=function(b){var c={};
a(b)?(c.borderRadius=1,c.shadow=!0,c.shared=!0,c.useHTML=!1,c.formatter=function(){return B(this,b.Chart.Series.ByName)}):b.RealChartType==QueryViewerChartType.StackedColumn100||b.RealChartType==QueryViewerChartType.StackedBar100||b.RealChartType==QueryViewerChartType.StackedArea100||b.RealChartType==QueryViewerChartType.StackedLine100?c.formatter=function(){return"<b>"+(""!=this.point.id?this.point.id:this.series.name)+"</b>: "+Math.round(100*this.point.percentage)/100+"%"}:d(b)?c.formatter=function(){var a;
if(l(b)){a=qv.collection[this.point.series.chart.options.qv.viewerId];var c=k(a),e=r(a,this.point.index),d=0<e.length?e[0].id:"",g=""!=d,f="";g&&(f+=t(d,c?qv.util.GetColorStringFromHighchartsObject(a,this):""));for(d=0;d<e.length;d++)var h=e[d],f=f+((g||0<d?"<br/>":"")+t(h.series.name+": ",c?"":qv.util.GetColorStringFromHighchartsObject(a,h.series))),h=Math.round(100*h.percentage)/100,f=f+(h+"%");a=f}else h=Math.round(100*this.point.percentage)/100,a="<b>"+(""!=this.point.name?this.point.name:this.point.series.name)+
"</b>: "+h+"%";return a}:b.RealChartType==QueryViewerChartType.CircularGauge?(c.enabled=(1<b.Chart.Series.DataFields.length||!gx.lang.gxBoolean(b.ShowValues))&&!l(b),c.formatter=function(){return q(this,b)},c.positioner=function(a){return{x:(this.chart.plotWidth-a)/2,y:this.chart.plotHeight/2}}):c.formatter=function(){var a;var c=b.Chart.Series.ByName;if(!l(b)||n(b)){a=qv.collection[this.series.chart.options.qv.viewerId];var e=c[this.series.name],c=n(a)?"ZZZZZZZZZZZZZZ9.99":e.Picture,d=n(a)?2:e.NumberFormat.DecimalPrecision,
e=n(a);a="<b>"+(""!=this.point.id?this.point.id:this.series.name)+"</b>: "+qv.util.formatNumber(this.point.y,d,c,e)+(n(a)?"%":"")}else{this.points?(a=this.points[0],e=a.point.index):(a=this.point,e=a.index);a=qv.collection[a.series.chart.options.qv.viewerId];var d=k(a),g=r(a,e),e=!this.key?!this.x?"":this.x:this.key,f=""!=e&&a.RealChartType!=QueryViewerChartType.Sparkline,h="";f&&(h+=t(e,d?qv.util.GetColorStringFromHighchartsObject(a,this):""));for(var x=0;x<g.length;x++)var o=g[x],e=c[o.series.name],
h=h+((f||0<x?"<br/>":"")+t(o.series.name+": ",d?"":qv.util.GetColorStringFromHighchartsObject(a,o))),h=h+qv.util.formatNumber(o.y,e.NumberFormat.DecimalPrecision,e.Picture,!1);a=h}return a};return c}(e);K.series=function(b,e,d){function g(b,e,d,f,h){f={};b.ItemClick&&b.Metadata.Data[d].RaiseItemClick&&(f.className="highcharts-drilldown-point");f.visible=e.Visible==QueryViewerVisible.Yes||e.Visible==QueryViewerVisible.Always;f.events={legendItemClick:function(a){if(e.Visible==QueryViewerVisible.Always)a.preventDefault();
else{var c=qv.chart.GetRuntimeMetadata(b),a=qv.util.GetElementInCollection(c,"Name",b.Chart.Series.ByIndex[a.target.index].FieldName);a.Hidden=!a.Hidden;qv.util.autorefresh.UpdateLayoutSameGroup(b,c,false)}}};if(a(b)){f.name=e.Name;f.data=[];f.turboThreshold=0;qv.util.IsNullColor(e.Color)||qv.util.SetHighchartsColor(b,f,e.Color,!0);var x=D(b.Chart.Categories,e.Points,qv.util.XAxisDataType(b),e.Aggregation,h);for(j=0;j<x.length;j++){var d=x[j].name,k=x[j].x,h=x[j].y,k=new gx.date.gxdate(k,"Y4MD");
f.data[j]={x:k.Value.getTime()-6E4*k.Value.getTimezoneOffset(),y:h,name:d};qv.util.IsNullColor(e.Color)&&qv.util.SetHighchartsColor(b,f.data[j],e.Points[j].Color,!0)}}else{b.RealChartType==QueryViewerChartType.CircularGauge&&(x=l(b)?C(1,1):C(b.Chart.Series.DataFields.length,d+1));f.name=e.Name;f.data=[];f.turboThreshold=0;qv.util.IsNullColor(e.Color)||qv.util.SetHighchartsColor(b,f,e.Color,!0);if(b.RealChartType==QueryViewerChartType.Radar||b.RealChartType==QueryViewerChartType.FilledRadar||b.RealChartType==
QueryViewerChartType.PolarArea)f.pointPlacement=b.RealChartType==QueryViewerChartType.Radar||b.RealChartType==QueryViewerChartType.FilledRadar?"on":null;for(j=0;j<e.Points.length;j++)(h=null!=e.Points[j].Value?parseFloat(qv.util.trim(e.Points[j].Value).replace(",",".")):null,n(b)&&(h=100*(h/e.TargetValue)),d=b.Chart.Categories.Values[j].ValueWithPicture,f.data[j]={},f.data[j].y=h,f.data[j].name=n(b)?"":d,f.data[j].id=f.data[j].name,c(b)&&(k=b.Chart.Categories.Values[j].Value,k=new gx.date.gxdate(k,
"Y4MD"),f.data[j].x=k.Value.getTime()-6E4*k.Value.getTimezoneOffset(),f.data[j].id=k),b.RealChartType==QueryViewerChartType.CircularGauge&&(f.data[j].radius=x.UpperExtreme.toString()+"%",f.data[j].innerRadius=x.LowerExtreme.toString()+"%"),b.RealChartType==QueryViewerChartType.CircularGauge)?(d=qv.util.IsNullColor(e.Color)?e.Points[0].Color:e.Color,qv.util.SetHighchartsColor(b,f.data[j],d,!0)):qv.util.IsNullColor(e.Color)&&qv.util.SetHighchartsColor(b,f.data[j],e.Points[j].Color,!0)}return f}var f=
[],h=0,x;for(x in b.Chart.Series.ByName){if(!l(b)||h==e){var k=g(b,b.Chart.Series.ByName[x],h,f,d),o=null!=e?e:h;m(b)&&(0==o%2?(k.type="column",k.yAxis=0):(k.type="line",k.yAxis=l(b)?0:1));f.push(k)}h++}return f}(e,h,p);return K}function G(a){var b="";if(""==a.YAxisTitle){if(1==a.Chart.Series.DataFields.length){var c;a:for(b=0;b<a.Metadata.Data.length;b++)if(a.Metadata.Data[b].DataField==a.Chart.Series.DataFields[0]){c=a.Metadata.Data[b];break a}b=gx.getMessage(c.Title)}}else b=gx.getMessage(a.YAxisTitle);
return b}function A(a){return!isNaN(parseFloat(a))&&isFinite(a)?gx.dom.el(V+"_Zoom_"+a+"m"):gx.dom.el(a)}function y(a,b){if(zoom=A(a))zoom.style.textDecoration=b}function z(a){if(zoom=A(a))zoom.onclick();else if(0!=a){var b;switch(a){case 12:b=6;break;case 6:b=3;break;case 3:b=2;break;case 2:b=1;break;case 1:b=0}z(b)}}function w(a,b){gx.dom.el(a+"_options_compare_enable").disabled=!b;gx.dom.el(a+"_options_compare_text").disabled=!b;gx.dom.el(a+"_options_compare_text").style.opacity=!b?0.5:1;gx.dom.el(a+
"_options_compare_options").disabled=!b;gx.dom.el(a+"_options_compare_options").style.opacity=!b?0.5:1}function F(a){return a+"_options"}function E(a){return a+"_center"}function H(a){return a+"_footer_slider"}function fa(a){return a+"_footer_chart"}function W(a){return a+"_footer_range"}function ca(a){return a+"_footer_left_cursor"}function ba(a){return a+"_footer_right_cursor"}function R(a){return a+"_footer_center"}function U(a,b,c){var e=Math.max(b,0),b=Math.min(e,100),e=Math.max(c,0),c=Math.min(e,
100);$("#"+(a+"_footer")).css("width","100%").css("height",S.toString()+"px");$("#"+fa(a)).css("width","100%").css("height",(S-2).toString()+"px");e=qv.collection[a].getContainerControl().offsetWidth;b=b*e/100;c=(100-c)*e/100;if(e-b-c<2*T){var d=2*T-(e-b-c),g;g=0==d%2?d/2:(d+1)/2;b-=g;c-=d-g;0>b&&(c+=b,b=0);0>c&&(b+=c,c=0)}$("#"+H(a)).css("width","100%").css("height",S.toString()+"px").css("padding-left",(100*b/e).toString()+"%").css("padding-right",(100*c/e).toString()+"%");$("#"+W(a)).css("width",
"100%").css("height",S.toString()+"px");$("#"+ca(a)).css("width",T.toString()+"px").css("height",S.toString()+"px");$("#"+ba(a)).css("width",T.toString()+"px").css("height",S.toString()+"px");$("#"+R(a)).css("width","calc(100% - "+2*T+"px)").css("height",S.toString()+"px").css("left",T.toString()+"px")}function X(a,b){var c=parseInt($("#"+H(a)).css("padding-left")),e=parseInt($("#"+W(a)).css("width")),d;d=b.originalEvent.touches?b.originalEvent.touches[0].pageX-b.originalEvent.touches[0].target.offsetLeft:
b.offsetX;switch(b.target.id){case H(a):return d;case ca(a):return d+c;case R(a):return d+c;case ba(a):return d+c+e-T}}function L(b){function c(a){a.preventDefault();N=b;var e=$("#"+H(N)),d=$("#"+W(N));parseInt(e.css("padding-left"));ja=X(N,a);da=parseInt(e.css("padding-left"));ga=parseInt(e.css("padding-right"));ea=parseInt(e.css("width"));ha=parseInt(d.css("width"))}function e(){if(Z||P||Q){var b=$("#"+H(N)),c=qv.collection[N],d=gx.dom.el(N+"_options_compare_enable").checked,g=c.getContainerControl().offsetWidth,
f;f=a(c)?E(c.userControlId()):c.getContainerControl().id;var c=l(c)?$("[id^="+f+"_chart]"):$("#"+f),h=[];$.each(c,function(a,b){var c=$("#"+b.id).highcharts();h.push(c)});c=h[0];f=parseInt(b.css("padding-left"));var k=parseInt(b.css("padding-right")),b=100*f/g,g=100*(1-k/g);if(0==b&&100==g)$.each(h,function(a,b){b.zoomOut()});else{c.get("xaxis").getExtremes();var c=c.options.qv,o=c.dataMin+b/100*(c.dataMax-c.dataMin),x=c.dataMin+g/100*(c.dataMax-c.dataMin),q=d?!1:!0;$.each(h,function(a,b){b.get("xaxis").setExtremes(o,
x,q)})}d&&aa(h);if(P||Q)y(Y,"none"),Y=null}P=Q=Z=!1}function d(a){if(Z||P||Q)if(a=X(N,a)-ja,a=Q?Math.min(a,ha-2*T):Math.min(a,ga),a=P?Math.max(a,-ha+2*T):Math.max(a,-da),0!=a){$("#"+R(N));var b=$("#"+H(N));$("#"+W(N));Q?b.css("padding-left",(100*(da+a)/ea).toString()+"%"):(P||b.css("padding-left",(100*(da+a)/ea).toString()+"%"),b.css("padding-right",(100*(ga-a)/ea).toString()+"%"))}}var g=$("#"+ca(b)),f=$("#"+ba(b)),h=$("#"+R(b)),k=$("#"+H(b));$("#"+W(b));g.mousedown(function(a){a.preventDefault();
Q=!0});f.mousedown(function(a){a.preventDefault();P=!0});h.mousedown(function(a){a.preventDefault();!Q&&!P&&(Z=!0)});k.mousedown(function(a){c(a)});$(document).mouseup(function(a){e(a)});k.mousemove(function(a){d(a)});g.on("touchstart",function(a){a.preventDefault();Q=!0});f.on("touchstart",function(a){a.preventDefault();P=!0});h.on("touchstart",function(a){a.preventDefault();!Q&&!P&&(Z=!0)});k.on("touchstart",function(a){c(a)});$(document).on("touchend",function(a){e(a)});$(document).on("touchcancel",
function(a){e(a)});k.on("touchmove",function(a){d(a)})}function J(a,b){var c=qv.util.dom.createDiv(a,H(b),"gx-qv-footer-slider","",{},""),c=qv.util.dom.createDiv(c,W(b),"gx-qv-footer-range","",{},"");qv.util.dom.createDiv(c,ca(b),"gx-qv-footer-left-cursor","",{},"");qv.util.dom.createDiv(c,ba(b),"gx-qv-footer-right-cursor","",{},"");qv.util.dom.createDiv(c,R(b),"gx-qv-footer-center","",{},"");qv.util.dom.createDiv(a,fa(b),"gx-qv-footer-chart","",{},"")}function ka(a,b){var c=fa(a.userControlId()),
e=a.RealChartType==QueryViewerChartType.SmoothTimeline?"spline":"line",d=a.RealChartType==QueryViewerChartType.StepTimeline?"left":"",g=[];if(l(a))for(f=0;f<b.length;f++)g.push(b[f].series[0]);else for(var f=0;f<b[0].series.length;f++)g.push(b[0].series[f]);return qv.chart.getSparklineChartOptions(a,c,e,!1,d,g)}function aa(a){var b=a[0],c=b.options.qv.viewerId,e=qv.collection[c],d=gx.dom.el(c+"_options_compare_enable").checked;$.each(a,function(a,b){b.options.qv.comparing=d});var g=b.get("xaxis").getExtremes();
void 0!=g.userMin&&(g.min=g.userMin);void 0!=g.userMax&&(g.max=g.userMax);if(d){var f=gx.dom.el(c+"_options_compare_options").children,h;for(ind=0;void 0!=f[ind]&&void 0==h;ind++)f[ind].selected&&(h=f[ind].value);var k,o;"PrevPeriod"==h?(o=new Date(g.min),k=new Date(g.min-(g.max-g.min))):"PrevYear"==h&&(k=new Date(g.min),k=new Date(k.setFullYear(k.getFullYear()-1)),o=new Date(g.max),o=new Date(o.setFullYear(o.getFullYear()-1)));k=k.getTime();o=o.getTime();if(zoom=A(c+"_Zoom_0m"))zoom.style.display=
"none"}else if(zoom=A(c+"_Zoom_0m"))zoom.style.display="";$.each(a,function(a,b){for(var c=[];b.series.length>0;){b.options.qv.colorIndexesUsed||c.push(b.series[0].colorIndex);b.series[0].remove(true)}if(!b.options.qv.colorIndexesUsed)b.options.qv.colorIndexesUsed=c});var f=0,q;for(q in e.Chart.Series.ByName){var t=e.Chart.Series.ByName[q],p,m;l(e)?(p=a[f],m=p.options.qv.colorIndexesUsed[0]):(p=b,m=p.options.qv.colorIndexesUsed[f]);var n={turboThreshold:0};n.colorIndex=m;n.id=q+"1";n.name=q;n.data=
[];if(d){var v={className:"highcharts-dashed-series-line",turboThreshold:0};v.colorIndex=m;v.id=q+"2";v.name=q;v.data=[]}m=document.getElementById(c+"_options_group_options").value;t=D(e.Chart.Categories,t.Points,qv.util.XAxisDataType(e),t.Aggregation,m);for(i=0;i<t.length;i++){m=t[i].y;var u=new gx.date.gxdate(t[i].x,"Y4MD"),B=t[i].name,r=u.Value.getTime()-6E4*u.Value.getTimezoneOffset(),u=u.Value.getTime()-6E4*u.Value.getTimezoneOffset();if(d){var C=!1,s=!1;r<=g.max&&r>=g.min&&(C=!0);if(r<=o&&r>=
k){var s=!0,w=new Date(r),y;"PrevPeriod"==h?y="1m"==p.options.qv.predef_zoom?w.setMonth(w.getMonth()+1):"2m"==p.options.qv.predef_zoom?w.setMonth(w.getMonth()+2):"3m"==p.options.qv.predef_zoom?w.setMonth(w.getMonth()+3):"6m"==p.options.qv.predef_zoom?w.setMonth(w.getMonth()+6):"12m"==p.options.qv.predef_zoom?w.setFullYear(w.getFullYear()+1):y+(g.max-g.min):"PrevYear"==h&&(y=w.setFullYear(w.getFullYear()+1))}C&&(C={},C.x=r,C.y=m,C.name=B,n.data.push(C));s&&(C={},C.x=y,C.y=m,C.name=B,C.real_x=u,v.data.push(C))}else n.data.push({x:r,
y:m,name:B})}p.addSeries(n);d&&p.addSeries(v);f++}}function la(a,b){if(a.length<b)return 0;var c=(a[a.length-1].x-a[a.length-b].x)/1E3/3600/24/(365/12);return 1>=c?1:2>=c?2:3>=c?3:6>=c?6:12}function ma(a,b){function c(a,b,e,d,g,f,h,k,o){var l=b.userControlId(),a=qv.util.dom.createSelect(a,F(l)+"_group_options");qv.util.XAxisDataType(b)==QueryViewerDataType.DateTime&&(qv.util.dom.createOption(a,"Seconds","Seconds"==b._groupOption,gx.getMessage("GXPL_QViewerSeconds")),o&&(qv.util.dom.createOption(a,
"Minutes","Minutes"==b._groupOption,gx.getMessage("GXPL_QViewerMinutes")),k&&qv.util.dom.createOption(a,"Hours","Hours"==b._groupOption,gx.getMessage("GXPL_QViewerHours"))));if(C||qv.util.XAxisDataType(b)==QueryViewerDataType.Date)qv.util.dom.createOption(a,"Days","Days"==b._groupOption,gx.getMessage("GXPL_QViewerDays")),h&&(qv.util.dom.createOption(a,"Weeks","Weeks"==b._groupOption,gx.getMessage("GXPL_QViewerWeeks")),f&&(qv.util.dom.createOption(a,"Months","Months"==b._groupOption,gx.getMessage("GXPL_QViewerMonths")),
g&&(qv.util.dom.createOption(a,"Quarters","Quarters"==b._groupOption,gx.getMessage("GXPL_QViewerQuarters")),d&&(qv.util.dom.createOption(a,"Semesters","Semesters"==b._groupOption,gx.getMessage("GXPL_QViewerSemesters")),e&&qv.util.dom.createOption(a,"Years","Years"==b._groupOption,gx.getMessage("GXPL_QViewerYears"))))));return a}var e=a[0];V=e.options.qv.viewerId;var d=qv.collection[V],g=document.getElementById(F(V)),f=document.getElementById(V+"_footer"),h=e.get("xaxis").getExtremes(),k=h.dataMax-
h.dataMin;$.each(a,function(a,b){b.options.qv.dataMax=h.dataMax;b.options.qv.dataMin=h.dataMin});var o=2628288E3<k,l=5255712E3<k,q=7884E6<k,t=15768E6<k,k=31536E6<k;d._groupOption=d._groupOption||(qv.util.XAxisDataType(d)==QueryViewerDataType.Date?"Days":"Seconds");var p=new gx.date.gxdate(""),m=new gx.date.gxdate("");p.Value.setTime(h.dataMin+6E4*p.Value.getTimezoneOffset());m.Value.setTime(h.dataMax+6E4*m.Value.getTimezoneOffset());var n=!0,v=!0,u=!0,r=!0,B=!0,C=!0,D=!0,s=!0;gx.date.year(p)==gx.date.year(m)&&
(n=!1,6>=gx.date.month(p)&&7<=gx.date.month(m)||(v=!1,3>=gx.date.month(p)&&4<=gx.date.month(m)||(6>=gx.date.month(p)&&7<=gx.date.month(m)||9>=gx.date.month(p)&&10<=gx.date.month(m))||(u=!1,gx.date.month(p)==gx.date.month(m)&&(r=!1,gx.date.day(p)-gx.date.dow(p)==gx.date.day(m)-gx.date.dow(m)&&(B=!1,gx.date.day(p)==gx.date.day(m)&&(C=!1,gx.date.hour(p)==gx.date.hour(m)&&(D=!1,gx.date.minute(p)==gx.date.minute(m)&&(s=!1))))))));(function(a,b,e,d,g,f,h,k,o,l,q,t,p,x){function m(a){return qv.util.dom.createDiv(a,
"","QVTimelineHeaderGroup","",{height:ia+"px",flexGrow:1},"")}function n(a,b,c){return qv.util.dom.createAnchor(a,c,{cursor:"pointer",paddingLeft:"6px"},b)}var v=b.userControlId(),a=qv.util.dom.createDiv(a,"","QVTimelineHeader","",{display:"flex",flexDirection:"row",flexWrap:"wrap"},""),u=m(a),r=m(a),B=m(a),u=qv.util.dom.createDiv(u,"","","",{"float":"left"},"");qv.util.dom.createText(u,gx.getMessage("GXPL_QViewerJSChartZoom"));if(e){n(u,gx.getMessage("GXPL_QViewerJSChartZoomLevelToOneMonth"),v+"_Zoom_1m");
if(d){n(u,gx.getMessage("GXPL_QViewerJSChartZoomLevelToTwoMonth"),v+"_Zoom_2m");if(g){n(u,gx.getMessage("GXPL_QViewerJSChartZoomLevelToThreeMonth"),v+"_Zoom_3m");if(f){n(u,gx.getMessage("GXPL_QViewerJSChartZoomLevelToSixMonth"),v+"_Zoom_6m");h&&n(u,gx.getMessage("GXPL_QViewerJSChartZoomLevelToOneYear"),v+"_Zoom_12m")}}}}n(u,gx.getMessage("GXPL_QViewerJSChartZoomLevelToAll"),v+"_Zoom_0m");e=qv.util.dom.createDiv(r,"","","",{"float":"right",paddingLeft:"12px"},"");qv.util.dom.createSpan(e,F(v)+"_groupby_text",
"","",{whiteSpace:"nowrap",paddingRight:"6px"},null,gx.getMessage("GXPL_QViewerGroupBy"));c(e,b,k,o,l,q,t,p,x);b=qv.util.dom.createDiv(B,"","","",{"float":"right",paddingLeft:"12px"},"");qv.util.dom.createInput(b,F(v)+"_compare_enable","checkbox",{verticalAlign:"sub"});qv.util.dom.createSpan(b,F(v)+"_compare_text","","",{whiteSpace:"nowrap",paddingRight:"6px",paddingLeft:"6px"},null,gx.getMessage("GXPL_QViewerCompareWith"));v=qv.util.dom.createSelect(b,F(v)+"_compare_options");qv.util.dom.createOption(v,
"PrevPeriod",false,gx.getMessage("GXPL_QViewerPreviousPeriod"));qv.util.dom.createOption(v,"PrevYear",false,gx.getMessage("GXPL_QViewerPreviousYear"));return a})(g,d,o,l,q,t,k,n,v,u,r,B,D,s);J(f,V);L(V);gx.dom.el(g.id+"_compare_enable").onclick=function(){aa(a)};gx.dom.el(g.id+"_compare_options").onchange=function(){gx.dom.el(g.id+"_compare_enable").checked&&aa(a)};gx.dom.el(g.id+"_group_options").onchange=function(){aa(a)};var f=function(b){var c=gx.dom.el(g.id+"_compare_enable").checked;if(b>0){var d,
f;f=e.get("xaxis").getExtremes().dataMax;d=f-b*2628028800;var h=c?false:true;$.each(a,function(a,b){b.get("xaxis").setExtremes(d,f,h)});var k=e.options.qv;U(e.options.qv.viewerId,(d-k.dataMin)/(k.dataMax-k.dataMin)*100,(f-k.dataMin)/(k.dataMax-k.dataMin)*100);w(e.options.qv.viewerId,true)}else{$.each(a,function(a,b){b.zoomOut()});w(e.options.qv.viewerId,false)}y(Y,"none");y(this.id,"underline");$.each(a,function(a,c){c.options.qv.predef_zoom=b+"m"});Y=this.id;c&&aa(a)},o=[0,1,2,3,6,12],A;for(A in o)if(l=
o[A],q=gx.dom.el(V+"_Zoom_"+l+"m"))q.onclick=f.closure(q,[l]);A=la(e.series[0].points,20);z(A);d=ka(d,b);new Highcharts.Chart(d)}function na(b){var d=qv.collection[b.options.qv.viewerId];if(!c(d)){var g=d.SelectionAllowed(),f=!1;if(d.ItemClick)for(var k=0;k<d.Metadata.Axes.length;k++)if(d.Metadata.Axes[k].RaiseItemClick){f=!0;break}(f||g)&&jQuery.each(b.xAxis[0].ticks,function(c,d){d&&d.label&&(f&&d.label.addClass("gx-qv-clickable-element"),d.label.on("click",function(){var k=f,o=qv.collection[b.options.qv.viewerId],
l=!1;g&&!a(o)&&(l=e(o.Charts,d.pos));k&&(k=1==o.Chart.Categories.DataFields.length?qv.util.GetAxisByDataField(o,o.Chart.Categories.DataFields[0]).Name:"",h(o.ItemClickData,o,k,QueryViewerElementType.Axis,d.label.textStr,l,o.Data.Rows[c]),o.ItemClick())}))})}}var Y=null,V=null,ia=35,S=50,T=10,ja=0,N="",da=0,ga=0,ha=0,ea=0,Q=!1,P=!1,Z=!1;return{tryToRenderChart:function(b){var c="";(new Date).getTime();b.xml=b.xml||{};qv.services.GetRecordsetCacheKeyIfNeeded(b,function(b,e){var d=!1;b!=e.xml.recordsetCacheKey&&
(e.xml.recordsetCacheKey=b,d=!0);qv.util.anyError(b)?(c=qv.util.getErrorFromText(b),qv.util.renderError(e,c)):(d&&qv.services.parseRecordsetCacheKeyXML(e),qv.services.GetMetadataIfNeeded(e,function(b,e){var d=false;if(b!=e.xml.metadata){e.xml.metadata=b;d=true}(new Date).getTime();if(qv.util.anyError(b)){c=qv.util.getErrorFromText(b);qv.util.renderError(e,c)}else{d&&qv.services.parseMetadataXML(e);e.Metadata.ParserResult.Success?qv.services.GetDataIfNeeded(e,function(b,e){var d=false;if(b!=e.xml.data){e.xml.data=
b;d=true}(new Date).getTime();if(qv.util.anyError(b)){c=qv.util.getErrorFromText(b);qv.util.renderError(e,c)}else{d&&qv.services.parseDataXML(e);d=qv.util.GetContainerControlClasses(e);d!=""&&qv.util.SetUserControlClass(e,d);d=qv.util.ProcessDataAndMetadata(e);if(d==""){var g=e.userControlId(),d=qv.util.dom.getEmptyContainer(e);if((a(e)||l(e))&&d.offsetHeight==0)d.style.height="400px";if(a(e)){qv.util.dom.createDiv(d,F(g),"QVTimelineHeaderContainer","",{width:"100%",height:ia+"px"},"");var f=qv.util.dom.createDiv(d,
E(g),"","",{width:"100%",height:"calc(100% - "+ia+"px - "+S+"px)"},"");qv.util.dom.createDiv(d,g+"_footer","gx-qv-footer","",{width:"100%",height:S+"px"},"");d.style.padding=DEFAULTCHARTSPACING+"px";d=f}if(l(e))for(var f=e.Chart.Series.DataFields.length,h=parseInt(100/f),k=100%f,g=a(e)?E(g):g,o=0;o<f;o++)qv.util.dom.createDiv(d,g+"_chart"+o.toString(),"","",{width:"100%",height:(h+(o<k?1:0)).toString()+"%"},"");d=[];if(l(e)){var f=0,q;for(q in e.Chart.Series.ByName){h=p(e,e.Chart.Series.ByName[q],
f);d.push(h);f++}}else{h=p(e,null,null);d.push(h)}if(e.RealChartType==QueryViewerChartType.CircularGauge){q=qv.util.GetThemeStyleSheet(e);q.insertRule("#"+e.ContainerName+" .highcharts-tooltip-box {fill: none !important; stroke-width: 0 !important; }",q.cssRules.length)}Highcharts.setOptions({lang:{months:[gx.getMessage("GXPL_QViewerJanuary"),gx.getMessage("GXPL_QViewerFebruary"),gx.getMessage("GXPL_QViewerMarch"),gx.getMessage("GXPL_QViewerApril"),gx.getMessage("GXPL_QViewerMay"),gx.getMessage("GXPL_QViewerJune"),
gx.getMessage("GXPL_QViewerJuly"),gx.getMessage("GXPL_QViewerAugust"),gx.getMessage("GXPL_QViewerSeptember"),gx.getMessage("GXPL_QViewerOctober"),gx.getMessage("GXPL_QViewerNovember"),gx.getMessage("GXPL_QViewerDecember")],weekdays:[gx.getMessage("GXPL_QViewerSunday"),gx.getMessage("GXPL_QViewerMonday"),gx.getMessage("GXPL_QViewerTuesday"),gx.getMessage("GXPL_QViewerWednesday"),gx.getMessage("GXPL_QViewerThursday"),gx.getMessage("GXPL_QViewerFriday"),gx.getMessage("GXPL_QViewerSaturday")],shortMonths:[gx.getMessage("GXPL_QViewerJanuary").substring(0,
3),gx.getMessage("GXPL_QViewerFebruary").substring(0,3),gx.getMessage("GXPL_QViewerMarch").substring(0,3),gx.getMessage("GXPL_QViewerApril").substring(0,3),gx.getMessage("GXPL_QViewerMay").substring(0,3),gx.getMessage("GXPL_QViewerJune").substring(0,3),gx.getMessage("GXPL_QViewerJuly").substring(0,3),gx.getMessage("GXPL_QViewerAugust").substring(0,3),gx.getMessage("GXPL_QViewerSeptember").substring(0,3),gx.getMessage("GXPL_QViewerOctober").substring(0,3),gx.getMessage("GXPL_QViewerNovember").substring(0,
3),gx.getMessage("GXPL_QViewerDecember").substring(0,3)],numericSymbols:null}});q=[];for(f=0;f<d.length;f++){HCChart=new Highcharts.Chart(d[f],na);q.push(HCChart)}e.Charts=q;a(e)&&ma(q,d);e._ControlRenderedTo=e.RealType;qv.util.hideActivityIndicator(e)}else qv.util.renderError(e,d)}}):qv.util.renderError(e,e.Metadata.ParserResult.Message)}}))})},GetMetadataChart:function(a){var b=qv.util.GetDesigntimeMetadata(a);(function(a,b){function c(a,b,e){for(var d=0;d<a.length;d++){var g=a[d];if(g.Name==b){g.Visible=
e?QueryViewerVisible.Yes:QueryViewerVisible.No;break}}}if(a.PlotSeries==QueryViewerPlotSeries.InTheSameChart)for(var e=0;e<a.Charts[0].series.length;e++){var d=a.Charts[0].series[e],g=a.Chart.Series.ByIndex[e].FieldName;c(b,g,d.visible)}else for(e=0;e<a.Charts.length;e++)d=a.Charts[e].series[0],g=a.Chart.Series.ByIndex[e].FieldName,c(b,g,d.visible)})(a,b);return b},GetRuntimeMetadata:function(a){for(var b=[],c,e=c=0;e<a.Metadata.Axes.length;e++){var d=a.Metadata.Axes[e];d.Visible!=QueryViewerVisible.Never&&
(c+=1);b.push({Name:d.Name,Type:QueryViewerElementType.Axis,Axis:d.Axis,Position:d.Visible!=QueryViewerVisible.Never?c:null,Hidden:d.Visible==QueryViewerVisible.Never||d.Visible==QueryViewerVisible.No})}for(e=c=0;e<a.Metadata.Data.length;e++)d=a.Metadata.Data[e],d.Visible!=QueryViewerVisible.Never&&(c+=1),b.push({Name:d.Name,Type:QueryViewerElementType.Datum,Axis:"",Position:d.Visible!=QueryViewerVisible.Never?c:null,Hidden:d.Visible==QueryViewerVisible.Never||d.Visible==QueryViewerVisible.No});if(a.PlotSeries==
QueryViewerPlotSeries.InTheSameChart)for(c=0;c<a.Charts[0].series.length;c++)e=a.Charts[0].series[c],d=a.Chart.Series.ByIndex[c].FieldName,d=qv.util.GetElementInCollection(b,"Name",d),d.Hidden=!e.visible;else for(c=0;c<a.Charts.length;c++)e=a.Charts[c].series[0],d=a.Chart.Series.ByIndex[c].FieldName,d=qv.util.GetElementInCollection(b,"Name",d),d.Hidden=!e.visible;return b},GetDataChart:function(a){return a.xml.data},getSparklineChartOptions:function(a,b,c,e,d,g){a={chart:{}};a.chart.renderTo=b;a.chart.margin=
0;a.chart.type=c;a.chart.styledMode=!0;e&&(a.chart.className="highcharts-no-background");a.title={};a.title.text="";a.credits={};a.credits.enabled=!1;a.xAxis={};a.xAxis.visible=!1;a.yAxis={};a.yAxis.visible=!1;a.legend={};a.legend.enabled=!1;a.tooltip={};a.tooltip.enabled=!1;a.plotOptions={};a.plotOptions.series={};a.plotOptions.series.animation=!1;a.plotOptions.series.connectNulls=!0;a.plotOptions.series.enableMouseTracking=!1;a.plotOptions.series.lineWidth=1;a.plotOptions.series.shadow=!1;a.plotOptions.series.states=
{};a.plotOptions.series.states.hover={};a.plotOptions.series.states.hover.lineWidth=1;a.plotOptions.series.marker={};a.plotOptions.series.marker.radius=0;a.plotOptions.series.marker.states={};a.plotOptions.series.marker.states.hover={};a.plotOptions.series.marker.states.hover.radius=2;""!=d&&(a.plotOptions.series.step=d);a.series=[];for(b=0;b<g.length;b++)a.series.push(g[b]);return a},IsDatetimeXAxis:function(a){return c(a)},IsSingleSerieChart:function(a){return k(a)},IsAreaChart:function(a){return a.RealChartType==
QueryViewerChartType.Area||a.RealChartType==QueryViewerChartType.StackedArea||a.RealChartType==QueryViewerChartType.StackedArea100||a.RealChartType==QueryViewerChartType.SmoothArea||a.RealChartType==QueryViewerChartType.StepArea},IsLineChart:function(b){return b.RealChartType==QueryViewerChartType.Line||b.RealChartType==QueryViewerChartType.StackedLine||b.RealChartType==QueryViewerChartType.StackedLine100||b.RealChartType==QueryViewerChartType.SmoothLine||b.RealChartType==QueryViewerChartType.StepLine||
b.RealChartType==QueryViewerChartType.Sparkline||a(b)},IsSplittedChart:function(a){return l(a)},IsGaugeChart:function(a){return n(a)},Select:function(a,b){for(var c=[],e=0;e<a.Data.Rows.length;e++){var d=a.Data.Rows[e],f=!0;for(j=0;j<b.length;j++){var h=b[j];if(d[h.DataField]&&qv.util.trim(d[h.DataField])!=qv.util.trim(h.Value)){f=!1;break}}f&&c.push(e)}if(0<c.length){e=a.Charts;for(d=0;d<e.length;d++)for(var f=e[d],h=!1,k=0;k<c.length;k++)for(var o=c[k],q=0;q<f.series.length;q++)f.series[q].points[o].select(!0,
h),h||(h=!0)}else g(a.Charts)},Deselect:function(a){g(a.Charts)}}}();
qv.card=function(){function a(a,b){for(var c={},d=0;d<a.length;d++){var k=a[d],l;l=k;for(var q=b,m=[],v=[],n=[],u=0;u<q.length;u++){var r=q[u];if(l.IsFormula){var s=0;do{s++;var p=r[l.DataField+"_"+s.toString()];void 0!=p&&(p=parseFloat(p),0==u?n.push(p):n[s-1]+=p)}while(void 0!=p)}else l.Aggregation==QueryViewerAggregationType.Count?(s=0,r=parseFloat(r[l.DataField])):l.Aggregation==QueryViewerAggregationType.Average?(s=parseFloat(r[l.DataField+"_N"]),r=parseFloat(r[l.DataField+"_D"])):(s=parseFloat(r[l.DataField]),
r=1),m.push(s),v.push(r)}l=l.IsFormula?qv.util.evaluate(l.Formula,l.DataField+"_",n):qv.util.aggregate(l.Aggregation,m,v).toString();c[k.DataField]=l}return c}function c(a,b){if(0!=a.ConditionalStyles.length)for(var c=0;c<a.ConditionalStyles.length;c++){var d=a.ConditionalStyles[c];if(qv.util.satisfyStyle(b,d))return qv.util.css.parseStyle(d.StyleOrClass)}return qv.util.css.parseStyle(a.Style)}function d(a,b,c,d){function k(a,b){var c=gx.date.now(),e;switch(a){case QueryViewerTrendPeriod.LastYear:e=
gx.date.addyr(c,-1);break;case QueryViewerTrendPeriod.LastSemester:e=gx.date.addmth(c,-6);break;case QueryViewerTrendPeriod.LastQuarter:e=gx.date.addmth(c,-3);break;case QueryViewerTrendPeriod.LastMonth:e=gx.date.addmth(c,-1);break;case QueryViewerTrendPeriod.LastWeek:e=gx.date.dtadd(c,-604800);break;case QueryViewerTrendPeriod.LastDay:e=gx.date.dtadd(c,-86400);break;case QueryViewerTrendPeriod.LastHour:e=gx.date.dtadd(c,-3600);break;case QueryViewerTrendPeriod.LastMinute:e=gx.date.dtadd(c,-60);break;
case QueryViewerTrendPeriod.LastSecond:e=gx.date.dtadd(c,-1)}return qv.util.dateToString(e,b==QueryViewerDataType.DateTime)}var l={};if(a.IncludeTrend)if(a.TrendPeriod==QueryViewerTrendPeriod.SinceTheBeginning||""==a.TrendPeriod)l=0;else for(var q=k(a.TrendPeriod,d),l=a.Data.Rows.length-1,m=a.Data.Rows.length-2;0<=m&&!(a.Data.Rows[m][c]<q);m--)l=m;else l=a.Data.Rows.length-1;return l=function(a,b,c,e,d,g){var f=null,h=null,k=null,o=null,l=[],q={AnyTrend:!1};if(""!=c){for(var m=d.length-1,t=0,n=0,
r=0,B=0,s=0,R=0,U=null,X=null;a<=m;a++)if(void 0!=d[a][c]&&void 0!=d[a][e]){var t=t+1,L=new gx.date.gxdate(d[a][c],"Y4MD"),J=parseFloat(d[a][e]);l.push({x:L.Value.getTime()-6E4*L.Value.getTimezoneOffset(),y:J});if(null==f&&null==h)h=f=J,k=d[a][c],o=d[a][c];else if(J>h&&(o=d[a][c],h=J),J<f)k=d[a][c],f=J;a>=b&&(null==U&&null==X&&(U=L,X=J),L=g==QueryViewerDataType.Date?gx.date.daysDiff(L,U):gx.date.secDiff(L,U),J-=X,n+=L,r+=J,B+=L*J,s+=L*L,R+=J*J)}q.AnyTrend=1<t;q.Slope=(t*B-n*r)/(t*s-n*n);q.Intercept=
(r-q.Slope*n)/t;q.R2=Math.pow((t*B-n*r)/Math.sqrt((t*s-n*n)*(t*R-r*r)),2)}b={};b.LinearRegression=q;b.MinValue=f;b.MinWhen=k;b.MaxValue=h;b.MaxWhen=o;b.ChartSeriesData=l;return b}(a.IncludeSparkline||a.IncludeMaxAndMin?0:l,l,c,b.DataField,a.Data.Rows,d)}function b(b,c,e,d){function k(a,b){function c(a,b,e){var d=[];if(e)for(e=0;e<b.length;e++)d.push(b[e][a]);else d.push(b[b.length-1][a]);return d}for(var e=[],d=0;d<a.Metadata.Axes.length;d++){var g=a.Metadata.Axes[d];if(!g.IsComponent){var f={};f.Name=
g.Name;f.Values=c(g.DataField,a.Data.Rows,b);e.push(f)}}for(d=0;d<a.Metadata.Data.length;d++)g=a.Metadata.Data[d],g.IsComponent||(f={},f.Name=g.Name,f.Values=c(g.DataField,a.Data.Rows,b),e.push(f));return e}for(var l=null,q=0;q<c.Metadata.Data.length;q++)if(c.Metadata.Data[q].Name==e){l=c.Metadata.Data[q];break}null!=l&&(b.Name=l.Name,b.Type=QueryViewerElementType.Datum,b.Axis="",e=d?a(c.Metadata.Data,c.Data.Rows):c.Data.Rows[c.Data.Rows.length-1],b.Value=e[l.DataField],b.Context=k(c,d))}function k(a,
b){return a+"_card_sparkline_"+b}function m(a,b,c){c=k(a.userControlId(),c);return qv.chart.getSparklineChartOptions(a,c,"line",!0,"",[{data:b}])}function n(a,b,c,d){var k={textAlign:"center",paddingTop:"0px",paddingRight:"5px",paddingBottom:"0px",paddingLeft:"5px"},a=qv.util.dom.createTable(a,"",{}),l;l=qv.util.dom.createRow(a);l=qv.util.dom.createCell(l,1,"",k,"");qv.util.dom.createSpan(l,"","qv-card-max-and-min-value",c,{},null,b);l=qv.util.dom.createRow(a);l=qv.util.dom.createCell(l,1,"",k,"");
qv.util.dom.createSpan(l,"","qv-card-max-and-min-title",c,{},null,d);return a}function l(a){var a=new gx.date.gxdate(a,"Y4MD"),b=gx.date.now(),a=gx.date.secDiff(b,a);return gx.getMessage("GXPL_QViewerTimeAgo").replace("{0}",qv.util.seconsdToText(a))}function r(a,b,c,d){""!=b?(d=qv.util.formatNumber(parseFloat(b),d,c.Picture,!1),b=qv.util.formatNumber(parseFloat(100*b/c.TargetValue),2,"ZZZZZZZZZZZZZZ9.99",!1)+"%"):b=d="";switch(a.ShowDataAs){case QueryViewerShowDataAs.Values:return d;case QueryViewerShowDataAs.Percentages:return b;
case QueryViewerShowDataAs.ValuesAndPercentages:return d+" ("+b+")";default:return d}}function s(b){function h(a,b,c){var c=0<c.LinearRegression.Slope?"keyboard_arrow_up":0>c.LinearRegression.Slope?"keyboard_arrow_down":"drag_handle",e;e=""==b.TrendPeriod?gx.getMessage("GXPL_QViewerSinceTheBeginningTrend"):gx.getMessage("GXPL_QViewer"+b.TrendPeriod+"Trend");var d={width:"0px",marginLeft:"5px"};b.IncludeSparkline||(d.position="relative",d.top="2px");d.fontSize="36px";return c=qv.util.dom.createIcon(a,
e,d,c)}for(var e=0<b.Data.Rows.length,g=!0,o="",t,q=0;q<b.Metadata.Axes.length;q++){var s=b.Metadata.Axes[q];if(s.DataType==QueryViewerDataType.Date||s.DataType==QueryViewerDataType.DateTime){g=!1;o=s.DataField;t=s.DataType;break}}var v;e&&(v=g?a(b.Metadata.Data,b.Data.Rows):b.Data.Rows[b.Data.Rows.length-1]);var D=qv.util.dom.getEmptyContainer(b);s=b.IsAutoResize()?q="":q="100%";var q=qv.util.dom.createTable(D,qv.util.GetContainerControlClasses(b),{width:q,height:s}),q=qv.util.dom.createRow(q),D=
qv.util.dom.createCell(q,1,"center",{},""),q=b.Orientation==QueryViewerOrientation.Horizontal?"100%":"",s=b.Orientation==QueryViewerOrientation.Vertical?"100%":"",D=qv.util.dom.createTable(D,"",{width:q,height:s,whiteSpace:"nowrap"}),u;b.Orientation==QueryViewerOrientation.Horizontal&&(u=qv.util.dom.createRow(D));s=[];for(q=0;q<b.Metadata.Data.length;q++){var C=b.Metadata.Data[q];if(C.Visible==QueryViewerVisible.Yes||C.Visible==QueryViewerVisible.Always){var O=qv.util.ParseNumericPicture(C.DataType,
C.Picture).DecimalPrecision,p,G,A;e?(p=v[C.DataField],G=r(b,v[C.DataField],C,O),A=l(v[o])):A=G=p="";if((gx.lang.gxBoolean(b.IncludeTrend)||gx.lang.gxBoolean(b.IncludeSparkline)||gx.lang.gxBoolean(b.IncludeMaxAndMin))&&e){var y=d(b,C,o,t);s.push(y)}var z=c(C,p);p={};var w="qv-card-element-value";qv.util.startsWith(z,"{")&&qv.util.endsWith(z,"}")?p=JSON.parse(z):w=z;z=null;b.ItemClick&&C.RaiseItemClick&&(w+=(""==w?"":" ")+"gx-qv-clickable-element",z=function(){qv.card.fireItemClickEvent(event,b,g)});
b.Orientation==QueryViewerOrientation.Vertical&&(u=qv.util.dom.createRow(D));var F=b.Orientation==QueryViewerOrientation.Horizontal?"10px":"",E=b.Orientation==QueryViewerOrientation.Vertical?"10px":"",F=qv.util.dom.createCell(u,1,"center",{paddingRight:F,paddingLeft:F,paddingBottom:E,paddingTop:E},""),F=qv.util.dom.createTable(F,"",{}),E=qv.util.dom.createRow(F),E=qv.util.dom.createCell(E,1,"center",{},""),E=qv.util.dom.createTable(E,"",{}),E=qv.util.dom.createRow(E),H=qv.util.dom.createCell(E,1,
"center",{},"");qv.util.dom.createSpan(H,b.getContainerControl().id+"_"+C.Name,w,""!=o?A:"",p,z,G);var H=qv.util.dom.createCell(E,1,"",{},"");e&&(b.IncludeTrend&&!b.IncludeSparkline&&y.LinearRegression.AnyTrend)&&h(H,b,y);E=qv.util.dom.createRow(F);E=qv.util.dom.createCell(E,1,"center",{},"");span1=qv.util.dom.createSpan(E,"","qv-card-element-title",""!=o?A:"",{},null,C.Title);b.IncludeSparkline&&(""!=o&&e)&&(E=qv.util.dom.createRow(F),E=qv.util.dom.createCell(E,1,"",{},""),E=qv.util.dom.createTable(E,
"",{width:"100%"}),E=qv.util.dom.createRow(E),H=qv.util.dom.createCell(E,1,"",{width:"100%"},""),qv.util.dom.createDiv(H,k(b.userControlId(),q),"","",{height:"50px",width:"100%",minWidth:"100px"},""),H=qv.util.dom.createCell(E,1,"",{width:"0%"},""),e&&(b.IncludeTrend&&y.LinearRegression.AnyTrend)&&h(H,b,y));b.IncludeMaxAndMin&&(""!=o&&e)&&(E=qv.util.dom.createRow(F),E=qv.util.dom.createCell(E,1,"center",{},""),E=qv.util.dom.createTable(E,"",{"margin-top":"10px"}),E=qv.util.dom.createRow(E),H=qv.util.dom.createCell(E,
1,"",{},""),n(H,r(b,y.MinValue,C,O),l(y.MinWhen),gx.getMessage("GXPL_QViewerCardMinimum")),H=qv.util.dom.createCell(E,1,"",{},""),n(H,r(b,y.MaxValue,C,O),l(y.MaxWhen),gx.getMessage("GXPL_QViewerCardMaximum")))}}if(b.IncludeSparkline&&""!=o&&e)for(q=0;q<b.Metadata.Data.length;q++)e=m(b,s[q].ChartSeriesData,q),new Highcharts.Chart(e);b._ControlRenderedTo=b.RealType;qv.util.hideActivityIndicator(b)}return{tryToRenderCard:function(a){var b="";(new Date).getTime();a.xml=a.xml||{};qv.services.GetRecordsetCacheKeyIfNeeded(a,
function(a,c){var d=!1;a!=c.xml.recordsetCacheKey&&(c.xml.recordsetCacheKey=a,d=!0);qv.util.anyError(a)?(b=qv.util.getErrorFromText(a),qv.util.renderError(c,b)):(d&&qv.services.parseRecordsetCacheKeyXML(c),qv.services.GetMetadataIfNeeded(c,function(a,c){var e=false;if(a!=c.xml.metadata){c.xml.metadata=a;e=true}(new Date).getTime();if(qv.util.anyError(a)){b=qv.util.getErrorFromText(a);qv.util.renderError(c,b)}else{e&&qv.services.parseMetadataXML(c);c.Metadata.ParserResult.Success?qv.services.GetDataIfNeeded(c,
function(a,c){var e=false;if(a!=c.xml.data){c.xml.data=a;e=true}(new Date).getTime();if(qv.util.anyError(a)){b=qv.util.getErrorFromText(a);qv.util.renderError(c,b)}else{e&&qv.services.parseDataXML(c);s(c)}}):qv.util.renderError(c,c.Metadata.ParserResult.Message)}}))})},GetMetadataCard:function(a){return qv.util.GetDesigntimeMetadata(a)},GetDataCard:function(a){return a.xml.data},fireItemClickEvent:function(a,c,e){a=a.target.id;a=a.substr(a.lastIndexOf("_")+1);b(c.ItemClickData,c,a,e);c.ItemClick()}}}();
qv.map=function(){function a(a){var b=[];if(0<a.Chart.Categories.DataFields.length&&0<a.Chart.Series.DataFields.length)for(var c=0;c<a.Chart.Categories.Values.length;c++){var d=a.Chart.Categories.Values[c].Value,f=parseFloat(a.Chart.Series.ByIndex[0].Points[c].Value);a.MapLibrary===QueryViewerMapLibrary.ECharts?b.push({name:d,value:f}):b.push([axisvalue,f])}return b}function c(a){for(var a=a.Data.Rows,b=[],c,d=0;d<a.length;d++)c={name:a[d].F1,lat:a[d].F2,lon:a[d].F3,colorValue:a[d].F4},b.push(c);
return b}function d(a){return a.Chart.Series.ByIndex[0].Color.Color?"#"+a.Chart.Series.ByIndex[0].Color.Color:"#0F5B78"}function b(a){var b;if(a.MapType==QueryViewerMapType.Choropleth&&0==a.Chart.colorAxis.dataClasses.length)return b={min:0,maxColor:d(a)};if(a.MapType==QueryViewerMapType.Choropleth&&0!=a.Chart.colorAxis.dataClasses.length||a.MapType==QueryViewerMapType.Bubble&&0!=a.Chart.colorAxis.dataClasses.length||a.MapType==QueryViewerMapType.Point&&0!=a.Chart.colorAxis.dataClasses.length)return b=
a.Chart.colorAxis;if(a.MapType==QueryViewerMapType.Bubble&&0==a.Chart.colorAxis.dataClasses.length||a.MapType==QueryViewerMapType.Point&&0==a.Chart.colorAxis.dataClasses.length)b=[];return b}function k(a){var b;if(a.MapType==QueryViewerMapType.Choropleth)return b={enabled:!0};if(a.MapType==QueryViewerMapType.Bubble)return b=0!=a.Chart.colorAxis.dataClasses.length?{enabled:!0}:{enabled:!1};a.MapType==QueryViewerMapType.Point&&(b=0!=a.Chart.colorAxis.dataClasses.length?{enabled:!0}:{enabled:!1});return b}
function m(b){var g;if(b.MapType==QueryViewerMapType.Choropleth)return g=[{name:qv.util.getTitleObject(b,0).text,type:"map",borderColor:"gray",colorByPoint:!1,data:a(b),joinBy:["name","hc-key"],dataLabels:{enabled:!0,format:"{point.name}"}}];if(b.MapType==QueryViewerMapType.Bubble)return g=0==b.Chart.colorAxis.dataClasses.length?b.Chart.Series.ByIndex[0].Color.Color?[{color:"#E0E0E0",enableMouseTracking:!1},{name:qv.util.getTitleObject(b,0).text,type:"mapbubble",joinBy:["name","hc-key"],data:a(b),
styledMode:!1,color:d(b),showInLegend:!0,minSize:4,maxSize:"12%"}]:[{enableMouseTracking:!1},{name:qv.util.getTitleObject(b,0).text,type:"mapbubble",joinBy:["name","hc-key"],data:a(b),colorIndex:b.Metadata.Data[0].colorIndex,opacity:0.5,showInLegend:!0,minSize:4,maxSize:"12%"}]:[{color:"#E0E0E0",enableMouseTracking:!1},{name:qv.util.getTitleObject(b,0).text,type:"mapbubble",joinBy:["name","hc-key"],data:a(b),styledMode:!1,showInLegend:!0,minSize:4,maxSize:"12%"}];b.MapType==QueryViewerMapType.Point&&
(g=""!=b.Chart.colorAxis?[{borderColor:"#5B595A",showInLegend:!1},{type:"mapline",showInLegend:!1,enableMouseTracking:!1},{name:getTitleObject(b,0).text,type:"mappoint",colorKey:"colorValue",data:c(b)}]:[{borderColor:"#5B595A",showInLegend:!1},{type:"mapline",showInLegend:!1,enableMouseTracking:!1},{name:getTitleObject(b,0).text,type:"mappoint",color:d(b),data:c(b)}]);return g}function n(a){var b;if(a.MapType==QueryViewerMapType.Choropleth||a.MapType==QueryViewerMapType.Bubble)return b={};a.MapType==
QueryViewerMapType.Point&&(b={headerFormat:"",pointFormat:"<b>{point.name}</b><br>Lat: {point.lat}, Lon: {point.lon}, value:{point.colorValue}"});return b}function l(a){var b=(a._EmbeddedInDashboard?"DashboardViewer/":"")+"QueryViewer/"+(a.MapLibrary===QueryViewerMapLibrary.Highchart?"highcharts/":"Echarts/"),c;c={};if(a.Region==QueryViewerRegion.Country)b=b+"countries/"+a.Country.toLowerCase()+"-all.js",c="countries/"+a.Country.toLowerCase()+"/"+a.Country.toLowerCase()+"-all";else if(a.Region==QueryViewerRegion.Continent){c=
"custom/";b+="continents/";switch(a.Continent){case QueryViewerContinent.SouthAmerica:a="south-america";break;case QueryViewerContinent.NorthAmerica:a="north-america";break;default:a=a.Continent.toLowerCase()}c+=a;b+=a+".js"}else a.MapLibrary==QueryViewerMapLibrary.Highcharts?(c="custom/world-highres",b+="continents/world-highres.js"):(c="world",b+="World/world.js");return c={mapKey:c,mapDir:qv.services.url.getStaticDirectory()+b}}function r(a,b){var c;if(a.MapType==QueryViewerMapType.Choropleth&&
0!=a.Chart.colorAxis.dataClasses.length){c=[];for(var f=0;f<a.Chart.colorAxis.dataClasses.length;f++){var h={},h=a.Chart.colorAxis.dataClasses[f].from,k=a.Chart.colorAxis.dataClasses[f].to,l=a.Chart.colorAxis.dataClasses[f].color,m=void 0,m=null!=l?l:d(a),h={start:h,end:k,color:m};c.push(h)}c={left:"left",orient:"vertical",splitList:c,textStyle:b}}else a.MapType==QueryViewerMapType.Choropleth&&0==a.Chart.colorAxis.dataClasses.length&&(c=d(a),c={min:0,max:a.Chart.Series.ByIndex[0].MaxValue,calculable:!0,
orient:"horizontal",left:"center",color:[c,"white"],textStyle:b});return c}function s(b,c,f){var h=d(b),c={type:"map",map:l(b).mapKey,roam:!0,nameProperty:"iso-code",data:a(b),selectedMode:b.SelectionAllowed()?"single":!1,itemStyle:{normal:{label:{show:!1}},emphasis:{label:{show:!1},areaColor:b.MapType===QueryViewerMapType.Choropleth?f:"#eee"}},select:{label:{show:!1},itemStyle:{areaColor:c}}};if(b.MapType===QueryViewerMapType.Bubble){var f=b.getContainerControl(),k=Math.min(f.offsetWidth,f.offsetHeight),
m=b.Chart.Series.ByIndex[0].MaxValue;0===b.Chart.colorAxis.dataClasses.length&&(c.color=h);c.markPoint={symbol:"circle",symbolSize:function(a){return Math.sqrt(a/m)*k/10},itemStyle:{normal:{borderColor:qv.util.color.lightenDarkenColor(h,50),borderWidth:1,label:{show:!1}},emphasis:{borderColor:qv.util.color.lightenDarkenColor(h,100),borderWidth:2,label:{show:!1}}}}}return c}function f(a,b,c){for(var f=[],h=0;h<a.length;h++)for(var k=a[h].name,l=0;l<b._coordSysMgr._coordinateSystems[0].regions.length;l++)if(b._coordSysMgr._coordinateSystems[0].regions[l].name==
k){if(0!=c.Chart.colorAxis.dataClasses.length)for(k=0;k<c.Chart.colorAxis.dataClasses.length;k++){var m=c.Chart.colorAxis.dataClasses[k].to,n=a[h].value;c.Chart.colorAxis.dataClasses[k].from<n&&n<m&&(void 0!=b._coordSysMgr._coordinateSystems[0].regions[l].properties.center?f.push({name:a[h].name,coord:[b._coordSysMgr._coordinateSystems[0].regions[l].properties.center[0],b._coordSysMgr._coordinateSystems[0].regions[l].properties.center[1]],value:a[h].value,itemStyle:{color:c.Chart.colorAxis.dataClasses[k].color}}):
f.push({name:a[h].name,coord:[b._coordSysMgr._coordinateSystems[0].regions[l].center[0],b._coordSysMgr._coordinateSystems[0].regions[l].center[1]],value:a[h].value,itemStyle:{color:c.Chart.colorAxis.dataClasses[k].color}}))}else void 0!=b._coordSysMgr._coordinateSystems[0].regions[l].properties.center?f.push({name:a[h].name,coord:[b._coordSysMgr._coordinateSystems[0].regions[l].properties.center[0],b._coordSysMgr._coordinateSystems[0].regions[l].properties.center[1]],value:a[h].value,itemStyle:{color:d(c)}}):
f.push({name:a[h].name,coord:[b._coordSysMgr._coordinateSystems[0].regions[l].center[0],b._coordSysMgr._coordinateSystems[0].regions[l].center[1]],value:a[h].value,itemStyle:{color:d(c)}});break}return f}function h(b,c){0==b.offsetHeight&&(b.style.height="400px");var d=echarts.init(b),h=function(a){for(var b={fontFamily:"Source Sans Pro"},c="lightcoral",d=qv.util.GetThemeStyleSheet(a),d=d.rules||d.cssRules,a=qv.util.GetContainerControlClass(a),e=0;e<d.length;e++){var f=d[e].style;if(d[e].selectorText===
"."+a){if(f.fontFamily)b.fontFamily=f.fontFamily;if(f.fontSize)b.fontSize=f.fontSize;if(f.fontStyle)b.fontStyle=f.fontStyle;if(f.fontWeight)b.fontWeight=f.fontWeight;if(f.color)b.color=f.color}else if(d[e].selectorText==="."+a+" .gx-qv-selected-element")c=f.backgroundColor}return{TextStyle:b,SelectionColor:c,HoverColor:"#CCCCCC",BackgroundColor:"white"}}(c);d.clear();h={backgroundColor:h.BackgroundColor,series:s(c,h.SelectionColor,h.HoverColor),title:{text:gx.getMessage(c.Title),left:"center",textStyle:h.TextStyle},
dataRange:r(c,h.TextStyle),tooltip:function(a){return{trigger:"item",textStyle:a,formatter:function(a){for(var b=0;b<d._coordSysMgr._coordinateSystems[0].regions.length;b++)if(d._coordSysMgr._coordinateSystems[0].regions[b].name==a.name)return Number.isNaN(a.value)?d._coordSysMgr._coordinateSystems[0].regions[b].properties.name+" : 0":d._coordSysMgr._coordinateSystems[0].regions[b].properties.name+" : "+a.value}}}(h.TextStyle)};d.setOption(h);c.MapType==QueryViewerMapType.Bubble&&(h={series:{markPoint:{nameProperty:"iso-code",
data:f(a(c),d,c)}}},d.setOption(h));c.Charts=[d];(function(a){var b="try { qv.map.CheckMapSize("+a.me()+") } catch (e) {}";a.IntervalCheckChartSize=setInterval(b,500)})(c)}return{tryToRenderMap:function(a){function c(){var d=qv.util.ProcessDataAndMetadata(a);if(""==d){d=a.getContainerControl();qv.util.hideActivityIndicator(a);if(a.MapLibrary==QueryViewerMapLibrary.Highcharts){var f=a;Highcharts.mapChart(d,{chart:f.MapType==QueryViewerMapType.Bubble&&f.Chart.Series.ByIndex[0].Color.Color||f.MapType==
QueryViewerMapType.Choropleth&&0!=f.Chart.colorAxis.dataClasses.length&&!f.Chart.Series.ByIndex[0].Color.Color||f.MapType==QueryViewerMapType.Bubble&&0!=f.Chart.colorAxis.dataClasses.length&&!f.Chart.Series.ByIndex[0].Color.Color?{map:l(f).mapKey,styledMode:!1}:{map:l(f).mapKey,styledMode:!0},title:qv.util.getTitleObject(f,0),mapNavigation:{enabled:!0,buttonOptions:{verticalAlign:"bottom"}},tooltip:n(f),series:m(f),colorAxis:b(f),legend:k(f)})}else h(d,a);a._ControlRenderedTo=a.RealType}else qv.util.renderError(a,
d)}var d="";(new Date).getTime();a.xml=a.xml||{};qv.services.GetRecordsetCacheKeyIfNeeded(a,function(a,b){var e=!1;a!=b.xml.recordsetCacheKey&&(b.xml.recordsetCacheKey=a,e=!0);qv.util.anyError(a)?(d=qv.util.getErrorFromText(a),qv.util.renderError(b,d)):(e&&qv.services.parseRecordsetCacheKeyXML(b),qv.services.GetMetadataIfNeeded(b,function(a,b){var e=false;if(a!=b.xml.metadata){b.xml.metadata=a;e=true}(new Date).getTime();if(qv.util.anyError(a)){d=qv.util.getErrorFromText(a);qv.util.renderError(b,
d)}else{e&&qv.services.parseMetadataXML(b);b.Metadata.ParserResult.Success?qv.services.GetDataIfNeeded(b,function(a,b){var e=false;if(a!=b.xml.data){b.xml.data=a;e=true}(new Date).getTime();if(qv.util.anyError(a)){d=qv.util.getErrorFromText(a);qv.util.renderError(b,d)}else{e&&qv.services.parseDataXML(b);gx.http.loadScript(l(b).mapDir,c)}}):qv.util.renderError(b,b.Metadata.ParserResult.Message)}}))})},GetMetadataMap:function(a){return qv.util.GetDesigntimeMetadata(a)},GetDataMap:function(a){return a.xml.data},
CheckMapSize:function(a){var b=a.getContainerControl();if(b.offsetWidth!=a.Chart._lastWidth||b.offsetHeight!=a.Chart._lastHeight)a.Charts[0].resize({width:b.offsetWidth+"px",height:b.offsetHeight+"px"}),a.Chart._lastWidth=b.offsetWidth,a.Chart._lastHeight=b.offsetHeight},IsAfricanCountry:function(a){return 0<="DZ AO BJ BW BF BI CM CV CF TD KM CD DJ EG GQ ER SZ ET GA GM GH GN GW CI KE LS LR LY MG MW ML MR MU MA MZ NA NE NG CG RW ST SN SC SL SO ZA SS SD TZ TG TN UG EH ZM ZW".split(" ").indexOf(a)},
IsAsianCountry:function(a){return 0<="AF AZ AM BH BD BT BN KH CN CY TL GE IN ID IR IQ IL JP JO KZ KW KG LA LB MY MV MN MM NP KP OM PK PS PH QA RU SA SG KR LK PS SY TW TJ TH TR TM AE UZ VN YE".split(" ").indexOf(a)},IsEuropeanCountry:function(a){return 0<="AL AD AT AZ AM BY BE BA BG HR CY CZ DK EE FO FI FR GE DE GR HU IS IE IT XK LV LI LT LU MT MD MC ME NL MK NO PL PT RO RU SM RS SK SI ES SE CH TR UA GB VA".split(" ").indexOf(a)},IsNorthAmericanCountry:function(a){return 0<="AI AG BB BZ BM VG CA CR CU DM DO SV GL GD GT HT HN JM MX NI PA PR LC KN VC BS US TT".split(" ").indexOf(a)},
IsOceanianCountry:function(a){return 0<="AU CK FJ ID KI MY MH FM NR NC NZ PW PG PH WS SB TK TO TV VU".split(" ").indexOf(a)},IsSouthAmericanCountry:function(a){return 0<="AR BO BR CL CO EC GF GY PY PE SR TT UY VE".split(" ").indexOf(a)}}}();
